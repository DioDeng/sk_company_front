{"version":3,"file":"js/860.630fa03c.js","mappings":"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","sources":["webpack://web/./src/views/OrderView.vue","webpack://web/./src/views/OrderView.vue?77c4"],"sourcesContent":["<!-- eslint-disable vuejs-accessibility/label-has-for -->\n<template>\n  <section class=\"py-4\">\n    <div class=\"mb-3 d-flex justify-content-between\">\n      <ul class=\"list-unstyled\">\n        <li class=\"nav-item dropdown\">\n          <a\n            class=\"nav-link dropdown-toggle\"\n            href=\"#\"\n            role=\"button\"\n            data-bs-toggle=\"dropdown\"\n            aria-expanded=\"false\"\n          >\n            篩選\n          </a>\n          <ul class=\"dropdown-menu\">\n            <li>\n              <a\n                class=\"dropdown-item\"\n                href=\"#\"\n                @click.prevent=\"selectOption.sort = 'asc'\"\n                >新->舊</a\n              >\n            </li>\n            <li>\n              <a\n                class=\"dropdown-item\"\n                href=\"#\"\n                @click.prevent=\"selectOption.sort = ''\"\n                >舊->新</a\n              >\n            </li>\n            <li><hr class=\"dropdown-divider\" /></li>\n            <li>\n              <a\n                class=\"dropdown-item\"\n                href=\"#\"\n                @click.prevent=\"selectOption.keyword = undefined\"\n                >所有</a\n              >\n            </li>\n            <template v-for=\"(item, index) in companyList\" :key=\"index\">\n              <li>\n                <a\n                  class=\"dropdown-item\"\n                  href=\"#\"\n                  @click.prevent=\"selectOption.keyword = item._id\"\n                  >{{ item.companyName }}</a\n                >\n              </li>\n            </template>\n          </ul>\n        </li>\n      </ul>\n      <button\n        class=\"btn btn-dark\"\n        @click=\"this.$emitter.emit('addEditOrder', { status: true })\"\n      >\n        新增工單<i class=\"bi bi-plus-lg\"></i>\n      </button>\n    </div>\n    <table class=\"table table-striped table-hover\">\n      <thead>\n        <tr>\n          <th scope=\"col\">#</th>\n          <th scope=\"col\">廠商</th>\n          <th scope=\"col\">付款方式</th>\n          <th scope=\"col\">案子金額</th>\n          <th scope=\"col\">施工地址</th>\n          <th scope=\"col\">施工日期</th>\n          <th scope=\"col\">工人名單</th>\n          <th scope=\"col\">狀態</th>\n          <th scope=\"col\">修改</th>\n          <th scope=\"col\">檢視</th>\n        </tr>\n      </thead>\n      <tbody>\n        <template v-for=\"(item, index) in orderList\" :key=\"index\">\n          <tr>\n            <th scope=\"row\">{{ index + 1 }}</th>\n            <td>{{ item.company.companyName }}</td>\n            <td>{{ item.paymentMethod }}</td>\n            <td>${{ this.$toCurrency(item.total) }}</td>\n            <td>{{ item.address }}</td>\n            <td>{{ item.constructionDate }}</td>\n            <td>\n              <table class=\"table mb-0\">\n                <thead class=\"table-light\">\n                  <tr>\n                    <th scope=\"col\">#</th>\n                    <th scope=\"col\">姓名</th>\n                    <th scope=\"col\">電話</th>\n                    <th scope=\"col\">工作時數</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <template v-for=\"(data, num) in item.workers\" :key=\"num\">\n                    <tr>\n                      <th scope=\"row\">{{ num + 1 }}</th>\n                      <td>{{ data._id.name }}</td>\n                      <td>{{ data._id.phone }}</td>\n                      <td>{{ data.time }}</td>\n                    </tr>\n                  </template>\n                  <template\n                    v-for=\"(data, num) in item.transferWorkers\"\n                    :key=\"num\"\n                  >\n                    <tr>\n                      <th scope=\"row\">調用{{ num + 1 }}</th>\n                      <td>{{ data.name }}</td>\n                      <td>{{ data.phone }}</td>\n                      <td>{{ data.time }}</td>\n                    </tr>\n                  </template>\n                </tbody>\n              </table>\n            </td>\n            <td>\n              <button\n                type=\"button\"\n                class=\"btn\"\n                :class=\"[item.status ? 'btn-success' : 'btn-outline-danger']\"\n                @click=\"updateStatus(item)\"\n              >\n                <span v-if=\"item.status\">已完成</span><span v-else>未完成</span>\n              </button>\n            </td>\n            <td>\n              <button\n                class=\"btn btn-secondary\"\n                @click=\"\n                  this.$emitter.emit('editOrder', { status: false, data: item })\n                \"\n              >\n                <i class=\"bi bi-pencil\"></i>\n              </button>\n            </td>\n            <td>\n              <button\n                class=\"btn btn-warning\"\n                @click=\"this.$emitter.emit('pdfEmit', item)\"\n              >\n                <i class=\"bi bi-filetype-pdf\"></i>\n              </button>\n            </td>\n          </tr>\n        </template>\n      </tbody>\n    </table>\n  </section>\n</template>\n\n<script>\nimport {\n  apiGetOrders,\n  apiPatchOrderStatus,\n  apiGetCompanys,\n} from '@/assets/javascript/api';\nimport { getToken } from '@/assets/javascript/methods';\n\nexport default {\n  data() {\n    return {\n      companyList: [],\n      orderList: [],\n      selectOption: {\n        sort: 'asc',\n        keyword: undefined,\n      },\n    };\n  },\n  watch: {\n    // eslint-disable-next-line object-shorthand\n    'selectOption.sort'() {\n      this.getOrderList();\n    },\n    // eslint-disable-next-line object-shorthand\n    'selectOption.keyword'() {\n      this.getOrderList();\n    },\n  },\n  methods: {\n    checkSignIn() {\n      // 取得 cookie 中的 token\n      const token = getToken();\n\n      // 若有 token 則登入，反之轉為登入頁面\n      if (token) {\n        this.$http.defaults.headers.common.Authorization = `Bearer ${token}`;\n      } else {\n        this.$router.push('/login');\n      }\n    },\n    getOrderList() {\n      this.$emitter.emit('loadingStatus', true);\n      apiGetOrders(this.selectOption)\n        .then((res) => {\n          this.$emitter.emit('loadingStatus', false);\n          this.orderList = res.data.data;\n        })\n        .catch((err) => {\n          this.$emitter.emit('loadingStatus', false);\n          console.log(err.response.data.message);\n        });\n    },\n    updateStatus(status) {\n      this.$emitter.emit('loadingStatus', true);\n      apiPatchOrderStatus(status)\n        .then(() => {\n          this.getOrderList();\n          this.$emitter.emit('loadingStatus', false);\n        })\n        .catch((err) => {\n          console.log(err);\n          this.$emitter.emit('loadingStatus', false);\n        });\n    },\n    getCompanyList() {\n      this.$emitter.emit('loadingStatus', true);\n      apiGetCompanys()\n        .then((res) => {\n          this.$emitter.emit('loadingStatus', false);\n          this.companyList = res.data.data;\n        })\n        .catch((err) => {\n          this.$emitter.emit('loadingStatus', false);\n          console.log(err);\n        });\n    },\n  },\n  mounted() {\n    this.getOrderList();\n    this.getCompanyList();\n    this.$emitter.on('getOrder', () => {\n      this.getOrderList();\n    });\n  },\n  created() {\n    this.checkSignIn();\n  },\n};\n</script>\n","import { render } from \"./OrderView.vue?vue&type=template&id=f452b770\"\nimport script from \"./OrderView.vue?vue&type=script&lang=js\"\nexport * from \"./OrderView.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","href","role","scope","key","_hoisted_21","_hoisted_24","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","onClick","_cache","_withModifiers","$event","$data","selectOption","sort","_hoisted_7","keyword","undefined","_Fragment","_renderList","companyList","item","index","_id","companyName","_hoisted_8","$emitter","emit","status","_createTextVNode","_hoisted_9","_hoisted_10","_hoisted_11","orderList","_hoisted_12","_toDisplayString","company","paymentMethod","$toCurrency","total","address","constructionDate","_hoisted_13","_hoisted_14","workers","data","num","_hoisted_15","name","phone","time","transferWorkers","_hoisted_16","type","_normalizeClass","$options","updateStatus","_hoisted_18","_hoisted_19","_hoisted_17","_hoisted_22","_hoisted_20","_hoisted_25","_hoisted_23","watch","this","getOrderList","methods","checkSignIn","token","getToken","$http","defaults","headers","common","Authorization","$router","push","apiGetOrders","then","res","catch","err","console","log","response","message","apiPatchOrderStatus","getCompanyList","apiGetCompanys","mounted","on","created","__exports__","render"],"sourceRoot":""}