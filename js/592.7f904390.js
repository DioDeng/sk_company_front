"use strict";(self["webpackChunkweb"]=self["webpackChunkweb"]||[]).push([[592],{5044:function(t,e,a){a.d(e,{B1:function(){return m},Ck:function(){return c},IP:function(){return _},Jh:function(){return p},LW:function(){return y},Mu:function(){return d},Mz:function(){return w},RJ:function(){return g},TA:function(){return f},Vh:function(){return b},WA:function(){return $},fy:function(){return h},i3:function(){return l},mL:function(){return n},nx:function(){return i},rO:function(){return r},yb:function(){return u}});var s=a(1076);const o="https://skcompoany.zeabur.app",n=()=>s.Z.get(`${o}/admin/workers`),i=t=>s.Z.post(`${o}/admin/worker`,t),l=t=>s.Z.patch(`${o}/admin/worker`,t),d=t=>s.Z.delete(`${o}/admin/worker/${t}`),m=t=>s.Z.get(`${o}/admin/workerList/${t}`),r=()=>s.Z.get(`${o}/admin/companys`),u=t=>s.Z.post(`${o}/admin/company`,t),c=t=>s.Z.patch(`${o}/admin/company`,t),p=t=>s.Z.delete(`${o}/admin/company/${t}`),h=t=>s.Z.get(`${o}/admin/cooperateList/${t}`),g=t=>s.Z.get(`${o}/admin/orders`,{params:t}),_=t=>s.Z.get(`${o}/admin/order/${t}`),b=t=>s.Z.post(`${o}/admin/order`,t),f=t=>s.Z.patch(`${o}/admin/orderStatus`,t),$=t=>s.Z.patch(`${o}/admin/order`,t),y=t=>s.Z.delete(`${o}/admin/order/${t}`),w=t=>s.Z.post(`${o}/admin/sign_in`,t)},8769:function(t,e,a){a.d(e,{LP:function(){return s},qz:function(){return o}});const s=()=>{const t=document.cookie.replace(/(?:(?:^|.*;\s*)admin\s*=\s*([^;]*).*$)|^.*$/,"$1");return t},o=()=>{document.cookie="admin=;expires=;path=/"}},4592:function(t,e,a){a.r(e),a.d(e,{default:function(){return mt}});var s=a(3396),o=a(7139);const n={class:"py-4"},i={class:"mb-3 d-flex justify-content-between"},l=(0,s._)("ul",{class:"list-unstyled"},[(0,s._)("li",{class:"nav-item dropdown"},[(0,s._)("a",{class:"nav-link dropdown-toggle",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," 篩選 "),(0,s._)("ul",{class:"dropdown-menu"},[(0,s._)("li",null,[(0,s._)("a",{class:"dropdown-item",href:"#"},"Action")]),(0,s._)("li",null,[(0,s._)("a",{class:"dropdown-item",href:"#"},"Another action")]),(0,s._)("li",null,[(0,s._)("hr",{class:"dropdown-divider"})]),(0,s._)("li",null,[(0,s._)("a",{class:"dropdown-item",href:"#"},"Something else here")])])])],-1),d={class:"table table-striped table-hover"},m=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{scope:"col"},"#"),(0,s._)("th",{scope:"col"},"公司名"),(0,s._)("th",{scope:"col"},"負責人"),(0,s._)("th",{scope:"col"},"電話"),(0,s._)("th",{scope:"col"},"統編"),(0,s._)("th",{scope:"col"},"地址"),(0,s._)("th",{scope:"col"},"合作記錄"),(0,s._)("th",{scope:"col"},"修改")])],-1),r={scope:"row"},u=["onClick"],c=(0,s._)("i",{class:"bi bi-journal-text"},null,-1),p=[c],h=["onClick"],g=(0,s._)("i",{class:"bi bi-pencil"},null,-1),_=[g];function b(t,e,a,c,g,b){const f=(0,s.up)("AddEdit"),$=(0,s.up)("Cooper");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("section",n,[(0,s._)("div",i,[l,(0,s._)("button",{class:"btn btn-dark",onClick:e[0]||(e[0]=t=>this.$emitter.emit("addEditCom",{status:!0}))}," 新增廠商 ")]),(0,s._)("table",d,[m,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(g.companyList,((t,e)=>((0,s.wg)(),(0,s.iD)("tr",{key:e},[(0,s._)("th",r,(0,o.zw)(e+1),1),(0,s._)("td",null,(0,o.zw)(t.companyName),1),(0,s._)("td",null,(0,o.zw)(t.name),1),(0,s._)("td",null,(0,o.zw)(t.phone),1),(0,s._)("td",null,(0,o.zw)(t.taxIdNumber),1),(0,s._)("td",null,(0,o.zw)(t.address),1),(0,s._)("td",null,[(0,s._)("button",{class:"btn btn-dark",onClick:e=>this.$emitter.emit("cooperList",t._id)},p,8,u)]),(0,s._)("td",null,[(0,s._)("button",{class:"btn btn-success",onClick:e=>this.$emitter.emit("addEditCom",{status:!1,data:t})},_,8,h)])])))),128))])])]),(0,s.Wm)(f),(0,s.Wm)($)],64)}a(560);const f={class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"AddEdit"},$={class:"modal-dialog"},y={class:"modal-content"},w={class:"modal-header"},k={class:"modal-title fs-5",id:"exampleModalLabel"},D={key:0},C={key:1},v={class:"modal-body"},S={class:"form-floating mb-3"},x={for:"floatingInput"},M={class:"form-floating mb-3"},L={for:"floatingInput"},Z={class:"form-floating mb-3"},V={for:"phone"},W={class:"form-floating mb-3"},z={for:"floatingInput"},I={class:"form-floating mb-3"},E={for:"floatingInput"},N={class:"modal-footer justify-content-between"},U=(0,s._)("div",null,null,-1),A=["disabled"];function O(t,e,a,n,i,l){const d=(0,s.up)("VField"),m=(0,s.up)("ErrorMessage"),r=(0,s.up)("error-message"),u=(0,s.up)("VForm");return(0,s.wg)(),(0,s.iD)("div",f,[(0,s._)("div",$,[(0,s._)("div",y,[(0,s._)("div",w,[(0,s._)("h1",k,[i.status?((0,s.wg)(),(0,s.iD)("span",D,"新增公司")):((0,s.wg)(),(0,s.iD)("span",C,"修改公司"))]),(0,s._)("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=(...t)=>l.hideModal&&l.hideModal(...t)),"aria-label":"Close"})]),(0,s.Wm)(u,{ref:"formRefSignin",id:"profileForm",onSubmit:l.addEditCompany},{default:(0,s.w5)((({errors:t,meta:a})=>[(0,s._)("div",v,[(0,s._)("div",S,[(0,s.Wm)(d,{name:"廠商",type:"text",rules:"required",class:"form-control",modelValue:i.tempData.companyName,"onUpdate:modelValue":e[1]||(e[1]=t=>i.tempData.companyName=t)},null,8,["modelValue"]),(0,s._)("label",x,[(0,s.Uk)("廠商名稱"),(0,s.Wm)(m,{name:"廠商",class:"text-danger ms-3"})])]),(0,s._)("div",M,[(0,s.Wm)(d,{name:"負責人",type:"text",rules:"required",class:"form-control",modelValue:i.tempData.name,"onUpdate:modelValue":e[2]||(e[2]=t=>i.tempData.name=t)},null,8,["modelValue"]),(0,s._)("label",L,[(0,s.Uk)("負責人名稱"),(0,s.Wm)(m,{name:"負責人",class:"text-danger ms-3"})])]),(0,s._)("div",Z,[(0,s.Wm)(d,{id:"phone",name:"phone",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":t["電話"]}]),rules:l.isPhone,modelValue:i.tempData.phone,"onUpdate:modelValue":e[3]||(e[3]=t=>i.tempData.phone=t)},null,8,["class","rules","modelValue"]),(0,s._)("label",V,[(0,s.Uk)("phone"),(0,s.Wm)(r,{name:"phone",class:"text-danger ms-3"})])]),(0,s._)("div",W,[(0,s.Wm)(d,{name:"統一編號",class:"form-control",type:"text",rules:"length:10",modelValue:i.tempData.taxIdNumber,"onUpdate:modelValue":e[4]||(e[4]=t=>i.tempData.taxIdNumber=t)},null,8,["modelValue"]),(0,s._)("label",z,[(0,s.Uk)("統一編號"),(0,s.Wm)(m,{name:"統一編號",class:"ms-3 text-danger"})])]),(0,s._)("div",I,[(0,s.Wm)(d,{name:"地址",type:"text",modelValue:i.tempData.address,"onUpdate:modelValue":e[5]||(e[5]=t=>i.tempData.address=t),class:"form-control"},null,8,["modelValue"]),(0,s._)("label",E,[(0,s.Uk)("地址"),(0,s.Wm)(m,{name:"地址",class:"text-danger ms-3"})])])]),(0,s._)("div",N,[i.status?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("button",{key:0,type:"button",class:"btn btn-outline-danger",onClick:e[6]||(e[6]=(...t)=>l.deleteCompany&&l.deleteCompany(...t))}," 刪除廠商資料 ")),U,(0,s._)("button",{type:"submit",class:"btn btn-primary",disabled:!a.valid},"儲存",8,A)])])),_:1},8,["onSubmit"])])])],512)}var P=a(2166),J=a(5044),q={data(){return{modal:"",status:!1,tempData:{companyName:"",name:"",phone:"",taxIdNumber:"",address:""}}},methods:{isPhone(t){const e=/^(09)[0-9]{8}$/;return!!e.test(t)||"需要正確的電話號碼"},addEditCompany(){this.$emitter.emit("loadingStatus",!0),this.tempData._id?(0,J.Ck)(this.tempData).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"修改成功"}),this.$emitter.emit("getCompanyLsit"),this.$emitter.emit("loadingStatus",!1),this.hideModal()})).catch((t=>{this.$emitter.emit("messageModal",{status:!1,message:t.response.data.message}),this.$emitter.emit("loadingStatus",!1)})):(0,J.yb)(this.tempData).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"新增成功"}),this.$emitter.emit("getCompanyLsit"),this.$emitter.emit("loadingStatus",!1),this.hideModal()})).catch((t=>{this.$emitter.emit("messageModal",{status:!1,message:t.response.data.message}),this.$emitter.emit("loadingStatus",!1)}))},deleteCompany(){const t=prompt(`輸入該廠商ＩＤ：${this.tempData._id}`,"");t===this.tempData._id&&(0,J.Jh)(this.tempData._id).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"刪除成功"}),this.$emitter.emit("getCompanyLsit"),this.$emitter.emit("loadingStatus",!1),this.hideModal()})).catch((t=>{this.$emitter.emit("messageModal",{status:!1,message:t.response.data.message}),this.$emitter.emit("loadingStatus",!1)}))},showModal(){this.modal.show()},hideModal(){this.tempData={},this.modal.hide()}},mounted(){this.modal=new P.u_(this.$refs.AddEdit),this.$emitter.on("addEditCom",(t=>{this.status=t.status,t.status||(this.tempData=JSON.parse(JSON.stringify(t.data))),this.showModal()}))}},j=a(89);const F=(0,j.Z)(q,[["render",O]]);var H=F;const Y={class:"modal fade",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"cooperate"},B={class:"modal-dialog modal-lg"},K={class:"modal-content"},R=(0,s._)("div",{class:"modal-header"},[(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),T={class:"modal-body"},G={class:"table table-striped"},Q=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{scope:"col"},"#"),(0,s._)("th",{scope:"col"},"工程名稱"),(0,s._)("th",{scope:"col"},"金額"),(0,s._)("th",{scope:"col"},"日期"),(0,s._)("th",{scope:"col"},"是否完成")])],-1),X={scope:"row"},tt={key:0},et={key:1};function at(t,e,a,n,i,l){return(0,s.wg)(),(0,s.iD)("div",Y,[(0,s._)("div",B,[(0,s._)("div",K,[R,(0,s._)("div",T,[(0,s._)("table",G,[Q,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.tempData,((t,e)=>((0,s.wg)(),(0,s.iD)("tr",{key:e},[(0,s._)("th",X,(0,o.zw)(e+1),1),(0,s._)("td",null,(0,o.zw)(t._id),1),(0,s._)("td",null,(0,o.zw)(t.total),1),(0,s._)("td",null,(0,o.zw)(t.constructionDate),1),(0,s._)("td",null,[(0,s._)("button",{class:(0,o.C_)(["btn",[t.status?"btn-outline-success":"btn-outline-danger"]]),disabled:""},[t.status?((0,s.wg)(),(0,s.iD)("span",tt,"完工")):((0,s.wg)(),(0,s.iD)("span",et,"未完工"))],2)])])))),128))])])])])])],512)}var st={data(){return{modal:"",tempData:"",tempOrder:""}},methods:{getOrder(t){this.$emitter.emit("loadingStatus",!0),(0,J.IP)(t).then((t=>{this.$emitter.emit("loadingStatus",!1),this.tempOrder=t.data.data})).catch((t=>{this.$emitter.emit("loadingStatus",!1),console.log(t)}))},getCooperList(t){this.$emitter.emit("loadingStatus",!0),(0,J.fy)(t).then((t=>{this.$emitter.emit("loadingStatus",!1),this.tempData=t.data.data})).catch((t=>{this.$emitter.emit("loadingStatus",!1),console.log(t.response.data.message)}))},showModal(){this.modal.show()}},mounted(){this.modal=new P.u_(this.$refs.cooperate),this.$emitter.on("cooperList",(t=>{this.getCooperList(t),this.showModal()}))}};const ot=(0,j.Z)(st,[["render",at]]);var nt=ot,it=a(8769),lt={data(){return{companyList:[]}},components:{AddEdit:H,Cooper:nt},methods:{checkSignIn(){const t=(0,it.LP)();t?this.$http.defaults.headers.common.Authorization=`Bearer ${t}`:this.$router.push("/login")},getCompanys(){this.$emitter.emit("loadingStatus",!0),(0,J.rO)().then((t=>{this.companyList=t.data.data,this.$emitter.emit("loadingStatus",!1)})).catch((t=>{this.$emitter.emit("loadingStatus",!1),console.log(t)}))}},mounted(){this.getCompanys(),this.$emitter.on("getCompanyLsit",(()=>{this.getCompanys()}))},created(){this.checkSignIn()}};const dt=(0,j.Z)(lt,[["render",b]]);var mt=dt}}]);
//# sourceMappingURL=592.7f904390.js.map