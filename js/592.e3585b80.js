"use strict";(self["webpackChunkweb"]=self["webpackChunkweb"]||[]).push([[592],{5044:function(t,e,a){a.d(e,{B1:function(){return d},Ck:function(){return c},IP:function(){return f},Jh:function(){return p},LW:function(){return $},Mu:function(){return r},Mz:function(){return w},RJ:function(){return g},TA:function(){return _},Vh:function(){return b},WA:function(){return y},fy:function(){return h},i3:function(){return l},mL:function(){return o},nx:function(){return i},rO:function(){return m},yb:function(){return u}});var n=a(5121);const s="https://skcompoany.zeabur.app",o=()=>n.Z.get(`${s}/admin/workers`),i=t=>n.Z.post(`${s}/admin/worker`,t),l=t=>n.Z.patch(`${s}/admin/worker`,t),r=t=>n.Z.delete(`${s}/admin/worker/${t}`),d=t=>n.Z.get(`${s}/admin/workerList/${t}`),m=()=>n.Z.get(`${s}/admin/companys`),u=t=>n.Z.post(`${s}/admin/company`,t),c=t=>n.Z.patch(`${s}/admin/company`,t),p=t=>n.Z.delete(`${s}/admin/company/${t}`),h=t=>n.Z.get(`${s}/admin/cooperateList/${t}`),g=t=>n.Z.get(`${s}/admin/orders`,{params:t}),f=t=>n.Z.get(`${s}/admin/order/${t}`),b=t=>n.Z.post(`${s}/admin/order`,t),_=t=>n.Z.patch(`${s}/admin/orderStatus`,t),y=t=>n.Z.patch(`${s}/admin/order`,t),$=t=>n.Z.delete(`${s}/admin/order/${t}`),w=t=>n.Z.post(`${s}/admin/sign_in`,t)},8769:function(t,e,a){a.d(e,{LP:function(){return n},qz:function(){return s}});const n=()=>{const t=document.cookie.replace(/(?:(?:^|.*;\s*)admin\s*=\s*([^;]*).*$)|^.*$/,"$1");return t},s=()=>{document.cookie="admin=;expires=;path=/"}},4592:function(t,e,a){a.r(e),a.d(e,{default:function(){return dt}});var n=a(6252),s=a(3577);const o={class:"py-4"},i={class:"mb-3 d-flex justify-content-between"},l=(0,n._)("ul",{class:"list-unstyled"},[(0,n._)("li",{class:"nav-item dropdown"},[(0,n._)("a",{class:"nav-link dropdown-toggle",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," 篩選 "),(0,n._)("ul",{class:"dropdown-menu"},[(0,n._)("li",null,[(0,n._)("a",{class:"dropdown-item",href:"#"},"Action")]),(0,n._)("li",null,[(0,n._)("a",{class:"dropdown-item",href:"#"},"Another action")]),(0,n._)("li",null,[(0,n._)("hr",{class:"dropdown-divider"})]),(0,n._)("li",null,[(0,n._)("a",{class:"dropdown-item",href:"#"},"Something else here")])])])],-1),r={class:"table table-striped table-hover"},d=(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",{scope:"col"},"#"),(0,n._)("th",{scope:"col"},"公司名"),(0,n._)("th",{scope:"col"},"負責人"),(0,n._)("th",{scope:"col"},"電話"),(0,n._)("th",{scope:"col"},"統編"),(0,n._)("th",{scope:"col"},"地址"),(0,n._)("th",{scope:"col"},"合作記錄"),(0,n._)("th",{scope:"col"},"修改")])],-1),m={scope:"row"},u=["onClick"],c=(0,n._)("i",{class:"bi bi-journal-text"},null,-1),p=[c],h=["onClick"],g=(0,n._)("i",{class:"bi bi-pencil"},null,-1),f=[g];function b(t,e,a,c,g,b){const _=(0,n.up)("AddEdit"),y=(0,n.up)("Cooper");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("section",o,[(0,n._)("div",i,[l,(0,n._)("button",{class:"btn btn-dark",onClick:e[0]||(e[0]=t=>this.$emitter.emit("addEditCom",{status:!0}))}," 新增廠商 ")]),(0,n._)("table",r,[d,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(g.companyList,((t,e)=>((0,n.wg)(),(0,n.iD)("tr",{key:e},[(0,n._)("th",m,(0,s.zw)(e+1),1),(0,n._)("td",null,(0,s.zw)(t.companyName),1),(0,n._)("td",null,(0,s.zw)(t.name),1),(0,n._)("td",null,(0,s.zw)(t.phone),1),(0,n._)("td",null,(0,s.zw)(t.taxIdNumber),1),(0,n._)("td",null,(0,s.zw)(t.address),1),(0,n._)("td",null,[(0,n._)("button",{class:"btn btn-dark",onClick:e=>this.$emitter.emit("cooperList",t._id)},p,8,u)]),(0,n._)("td",null,[(0,n._)("button",{class:"btn btn-success",onClick:e=>this.$emitter.emit("addEditCom",{status:!1,data:t})},f,8,h)])])))),128))])])]),(0,n.Wm)(_),(0,n.Wm)(y)],64)}a(560);const _={class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"AddEdit"},y={class:"modal-dialog"},$={class:"modal-content"},w={class:"modal-header"},k={class:"modal-title fs-5",id:"exampleModalLabel"},v={key:0},D={key:1},C={class:"modal-body"},x={class:"form-floating mb-3"},S={for:"floatingInput"},M={class:"form-floating mb-3"},L={for:"floatingInput"},Z={class:"form-floating mb-3"},V={for:"phone"},W={class:"form-floating mb-3"},z={for:"floatingInput"},E={class:"form-floating mb-3"},I={for:"floatingInput"},O={class:"modal-footer justify-content-between"},A=(0,n._)("div",null,null,-1),N=["disabled"];function U(t,e,a,o,i,l){const r=(0,n.up)("VField"),d=(0,n.up)("ErrorMessage"),m=(0,n.up)("error-message"),u=(0,n.up)("VForm");return(0,n.wg)(),(0,n.iD)("div",_,[(0,n._)("div",y,[(0,n._)("div",$,[(0,n._)("div",w,[(0,n._)("h1",k,[i.status?((0,n.wg)(),(0,n.iD)("span",v,"新增公司")):((0,n.wg)(),(0,n.iD)("span",D,"修改公司"))]),(0,n._)("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=(...t)=>l.hideModal&&l.hideModal(...t)),"aria-label":"Close"})]),(0,n.Wm)(u,{ref:"formRefSignin",id:"profileForm",onSubmit:l.addEditCompany},{default:(0,n.w5)((({errors:t,meta:a})=>[(0,n._)("div",C,[(0,n._)("div",x,[(0,n.Wm)(r,{name:"廠商",type:"text",rules:"required",class:"form-control",modelValue:i.tempData.companyName,"onUpdate:modelValue":e[1]||(e[1]=t=>i.tempData.companyName=t)},null,8,["modelValue"]),(0,n._)("label",S,[(0,n.Uk)("廠商名稱"),(0,n.Wm)(d,{name:"廠商",class:"text-danger ms-3"})])]),(0,n._)("div",M,[(0,n.Wm)(r,{name:"負責人",type:"text",rules:"required",class:"form-control",modelValue:i.tempData.name,"onUpdate:modelValue":e[2]||(e[2]=t=>i.tempData.name=t)},null,8,["modelValue"]),(0,n._)("label",L,[(0,n.Uk)("負責人名稱"),(0,n.Wm)(d,{name:"負責人",class:"text-danger ms-3"})])]),(0,n._)("div",Z,[(0,n.Wm)(r,{id:"phone",name:"phone",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":t["電話"]}]),rules:l.isPhone,modelValue:i.tempData.phone,"onUpdate:modelValue":e[3]||(e[3]=t=>i.tempData.phone=t)},null,8,["class","rules","modelValue"]),(0,n._)("label",V,[(0,n.Uk)("phone"),(0,n.Wm)(m,{name:"phone",class:"text-danger ms-3"})])]),(0,n._)("div",W,[(0,n.Wm)(r,{name:"統一編號",class:"form-control",type:"text",rules:"length:10",modelValue:i.tempData.taxIdNumber,"onUpdate:modelValue":e[4]||(e[4]=t=>i.tempData.taxIdNumber=t)},null,8,["modelValue"]),(0,n._)("label",z,[(0,n.Uk)("統一編號"),(0,n.Wm)(d,{name:"統一編號",class:"ms-3 text-danger"})])]),(0,n._)("div",E,[(0,n.Wm)(r,{name:"地址",type:"text",modelValue:i.tempData.address,"onUpdate:modelValue":e[5]||(e[5]=t=>i.tempData.address=t),class:"form-control"},null,8,["modelValue"]),(0,n._)("label",I,[(0,n.Uk)("地址"),(0,n.Wm)(d,{name:"地址",class:"text-danger ms-3"})])])]),(0,n._)("div",O,[i.status?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("button",{key:0,type:"button",class:"btn btn-outline-danger",onClick:e[6]||(e[6]=(...t)=>l.deleteCompany&&l.deleteCompany(...t))}," 刪除廠商資料 ")),A,(0,n._)("button",{type:"submit",class:"btn btn-primary",disabled:!a.valid},"儲存",8,N)])])),_:1},8,["onSubmit"])])])],512)}var P=a(8877),j=a(5044),J={data(){return{modal:"",status:!1,tempData:{companyName:"",name:"",phone:"",taxIdNumber:"",address:""}}},methods:{isPhone(t){const e=/^(09)[0-9]{8}$/;return!!e.test(t)||"需要正確的電話號碼"},addEditCompany(){this.$emitter.emit("loadingStatus",!0),this.tempData._id?(0,j.Ck)(this.tempData).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"修改成功"}),this.$emitter.emit("getCompanyLsit"),this.$emitter.emit("loadingStatus",!1),this.hideModal()})).catch((t=>{this.$emitter.emit("messageModal",{status:!1,message:t.response.data.message}),this.$emitter.emit("loadingStatus",!1)})):(0,j.yb)(this.tempData).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"新增成功"}),this.$emitter.emit("getCompanyLsit"),this.$emitter.emit("loadingStatus",!1),this.hideModal()})).catch((t=>{this.$emitter.emit("messageModal",{status:!1,message:t.response.data.message}),this.$emitter.emit("loadingStatus",!1)}))},deleteCompany(){const t=prompt(`輸入該廠商ＩＤ：${this.tempData._id}`,"");t===this.tempData._id&&(0,j.Jh)(this.tempData._id).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"刪除成功"}),this.$emitter.emit("getCompanyLsit"),this.$emitter.emit("loadingStatus",!1),this.hideModal()})).catch((t=>{this.$emitter.emit("messageModal",{status:!1,message:t.response.data.message}),this.$emitter.emit("loadingStatus",!1)}))},showModal(){this.modal.show()},hideModal(){this.tempData={},this.modal.hide()}},mounted(){this.modal=new P.u_(this.$refs.AddEdit),this.$emitter.on("addEditCom",(t=>{this.status=t.status,t.status||(this.tempData=JSON.parse(JSON.stringify(t.data))),this.showModal()}))}},T=a(3744);const q=(0,T.Z)(J,[["render",U]]);var F=q;const H={class:"modal fade",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"cooperate"},Y={class:"modal-dialog modal-lg"},B={class:"modal-content"},K=(0,n._)("div",{class:"modal-header"},[(0,n._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),R={class:"modal-body"},G={class:"table table-striped"},Q=(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",{scope:"col"},"#"),(0,n._)("th",{scope:"col"},"工程名稱"),(0,n._)("th",{scope:"col"},"金額"),(0,n._)("th",{scope:"col"},"日期"),(0,n._)("th",{scope:"col"},"是否完成")])],-1),X={scope:"row"},tt={key:0},et={key:1};function at(t,e,a,o,i,l){return(0,n.wg)(),(0,n.iD)("div",H,[(0,n._)("div",Y,[(0,n._)("div",B,[K,(0,n._)("div",R,[(0,n._)("table",G,[Q,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.tempData,((t,e)=>((0,n.wg)(),(0,n.iD)("tr",{key:e},[(0,n._)("th",X,(0,s.zw)(e+1),1),(0,n._)("td",null,(0,s.zw)(t._id),1),(0,n._)("td",null,(0,s.zw)(t.total),1),(0,n._)("td",null,(0,s.zw)(t.constructionDate),1),(0,n._)("td",null,[(0,n._)("button",{class:(0,s.C_)(["btn",[t.status?"btn-outline-success":"btn-outline-danger"]]),disabled:""},[t.status?((0,n.wg)(),(0,n.iD)("span",tt,"完工")):((0,n.wg)(),(0,n.iD)("span",et,"未完工"))],2)])])))),128))])])])])])],512)}var nt={data(){return{modal:"",tempData:"",tempOrder:""}},methods:{getOrder(t){this.$emitter.emit("loadingStatus",!0),(0,j.IP)(t).then((t=>{this.$emitter.emit("loadingStatus",!1),this.tempOrder=t.data.data})).catch((t=>{this.$emitter.emit("loadingStatus",!1),console.log(t)}))},getCooperList(t){this.$emitter.emit("loadingStatus",!0),(0,j.fy)(t).then((t=>{this.$emitter.emit("loadingStatus",!1),this.tempData=t.data.data})).catch((t=>{this.$emitter.emit("loadingStatus",!1),console.log(t.response.data.message)}))},showModal(){this.modal.show()}},mounted(){this.modal=new P.u_(this.$refs.cooperate),this.$emitter.on("cooperList",(t=>{this.getCooperList(t),this.showModal()}))}};const st=(0,T.Z)(nt,[["render",at]]);var ot=st,it=a(8769),lt={data(){return{companyList:[]}},components:{AddEdit:F,Cooper:ot},methods:{checkSignIn(){const t=(0,it.LP)();t?this.$http.defaults.headers.common.Authorization=`Bearer ${t}`:this.$router.push("/login")},getCompanys(){this.$emitter.emit("loadingStatus",!0),(0,j.rO)().then((t=>{this.companyList=t.data.data,this.$emitter.emit("loadingStatus",!1)})).catch((t=>{this.$emitter.emit("loadingStatus",!1),console.log(t)}))}},mounted(){this.getCompanys(),this.$emitter.on("getCompanyLsit",(()=>{this.getCompanys()}))},created(){this.checkSignIn()}};const rt=(0,T.Z)(lt,[["render",b]]);var dt=rt},5649:function(t,e,a){var n=a(7697),s=a(2297),o=TypeError,i=Object.getOwnPropertyDescriptor,l=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=l?function(t,e){if(s(t)&&!i(t,"length").writable)throw new o("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},5565:function(t){var e=TypeError,a=9007199254740991;t.exports=function(t){if(t>a)throw e("Maximum allowed index exceeded");return t}},560:function(t,e,a){var n=a(9989),s=a(690),o=a(6310),i=a(5649),l=a(5565),r=a(3689),d=r((function(){return 4294967297!==[].push.call({length:4294967296},1)})),m=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},u=d||!m();n({target:"Array",proto:!0,arity:1,forced:u},{push:function(t){var e=s(this),a=o(e),n=arguments.length;l(a+n);for(var r=0;r<n;r++)e[a]=arguments[r],a++;return i(e,a),a}})}}]);
//# sourceMappingURL=592.e3585b80.js.map