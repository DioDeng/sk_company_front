(function(){"use strict";var t={5044:function(t,e,a){a.d(e,{B1:function(){return d},Ck:function(){return c},IP:function(){return b},Jh:function(){return p},LW:function(){return v},Mu:function(){return r},Mz:function(){return $},PX:function(){return x},RJ:function(){return f},TA:function(){return _},Vh:function(){return g},WA:function(){return y},WD:function(){return D},fy:function(){return h},i3:function(){return i},mL:function(){return l},nx:function(){return n},pk:function(){return w},rO:function(){return m},w_:function(){return k},yb:function(){return u}});var s=a(5121);const o="https://skcompoany.zeabur.app",l=()=>s.Z.get(`${o}/admin/workers`),n=t=>s.Z.post(`${o}/admin/worker`,t),i=t=>s.Z.patch(`${o}/admin/worker`,t),r=t=>s.Z.delete(`${o}/admin/worker/${t}`),d=t=>s.Z.get(`${o}/admin/workerList/${t}`),m=()=>s.Z.get(`${o}/admin/companys`),u=t=>s.Z.post(`${o}/admin/company`,t),c=t=>s.Z.patch(`${o}/admin/company`,t),p=t=>s.Z.delete(`${o}/admin/company/${t}`),h=t=>s.Z.get(`${o}/admin/cooperateList/${t}`),f=t=>s.Z.get(`${o}/admin/orders`,{params:t}),b=t=>s.Z.get(`${o}/admin/order/${t}`),g=t=>s.Z.post(`${o}/admin/order`,t),_=t=>s.Z.patch(`${o}/admin/orderStatus`,t),y=t=>s.Z.patch(`${o}/admin/order`,t),v=t=>s.Z.delete(`${o}/admin/order/${t}`),k=()=>s.Z.get(`${o}/admin/todos`),w=t=>s.Z.post(`${o}/admin/todo`,t),D=t=>s.Z.patch(`${o}/admin/todo`,t),x=t=>s.Z.delete(`${o}/admin/todo/${t}`),$=t=>s.Z.post(`${o}/admin/sign_in`,t)},8769:function(t,e,a){a.d(e,{LP:function(){return s},qz:function(){return o}});const s=()=>{const t=document.cookie.replace(/(?:(?:^|.*;\s*)admin\s*=\s*([^;]*).*$)|^.*$/,"$1");return t},o=()=>{document.cookie="admin=;expires=;path=/"}},2159:function(t,e,a){var s=a(9963),o=a(2954),l=a(2387),n=a(6391),i=a(2389),r=a(2369),d=a.n(r),m=a(9391),u=a(8877),c=a(5121),p=a(2346);function h(t){const e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")}var f=a(6252);const b={class:"container-xl"};function g(t,e,a,s,o,l){const n=(0,f.up)("Navbar"),i=(0,f.up)("router-view"),r=(0,f.up)("Loading"),d=(0,f.up)("Message"),m=(0,f.up)("WorkRecordModal"),u=(0,f.up)("AddEditCompany"),c=(0,f.up)("AddEditOrder"),p=(0,f.up)("AddEditWorker"),h=(0,f.up)("PDF"),g=(0,f.up)("EditOrder"),_=(0,f.up)("CooperateModal");return(0,f.wg)(),(0,f.iD)(f.HY,null,[(0,f.Wm)(n),(0,f._)("section",b,[(0,f.Wm)(i)]),(0,f.Wm)(r),(0,f.Wm)(d),(0,f.Wm)(m),(0,f.Wm)(u),(0,f.Wm)(c),(0,f.Wm)(p),(0,f.Wm)(h),(0,f.Wm)(g),(0,f.Wm)(_)],64)}a(560);var _=a(3577);const y={class:"navbar navbar-expand-lg bg-dark border-bottom border-body","data-bs-theme":"dark"},v={class:"container"},k=(0,f._)("a",{class:"navbar-brand",href:"#"},"首頁",-1),w=(0,f._)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,f._)("span",{class:"navbar-toggler-icon"})],-1),D={class:"collapse navbar-collapse",id:"navbarSupportedContent"},x={class:"navbar-nav me-auto mb-2 mb-lg-0"},$={class:"nav-item"},W={class:"nav-item"},M={class:"nav-item"},V={class:"nav-item"};function C(t,e,a,s,o,l){const n=(0,f.up)("router-link");return(0,f.wg)(),(0,f.iD)("nav",y,[(0,f._)("div",v,[k,w,(0,f._)("div",D,[(0,f._)("ul",x,[(0,f._)("li",$,[(0,f._)("a",{class:(0,_.C_)(["nav-link",{active:"home"===o.path}]),"aria-current":"page",href:"#"},"Home",2)]),(0,f._)("li",W,[(0,f.Wm)(n,{to:"/order",class:(0,_.C_)(["nav-link",{active:"order"===o.path}])},{default:(0,f.w5)((()=>[(0,f.Uk)("工單")])),_:1},8,["class"])]),(0,f._)("li",M,[(0,f.Wm)(n,{to:"/personnel",class:(0,_.C_)(["nav-link",{active:"personnel"===o.path}])},{default:(0,f.w5)((()=>[(0,f.Uk)("員工")])),_:1},8,["class"])]),(0,f._)("li",V,[(0,f.Wm)(n,{to:"/company",class:(0,_.C_)(["nav-link",{active:"company"===o.path}])},{default:(0,f.w5)((()=>[(0,f.Uk)("廠商")])),_:1},8,["class"])])]),(0,f._)("button",{class:"btn btn-outline-success",type:"button",onClick:e[0]||(e[0]=(...t)=>l.signOut&&l.signOut(...t))},"登出")])])])}var U=a(8769),O={data(){return{path:""}},watch:{$route(){this.path=this.$route.name}},methods:{signOut(){(0,U.qz)(),this.$router.push("/login")}},mounted(){this.path=this.$route.name}},S=a(3744);const L=(0,S.Z)(O,[["render",C]]);var E=L;const I=t=>((0,f.dD)("data-v-5de688a9"),t=t(),(0,f.Cn)(),t),P={class:"vl-parent"},Z=I((()=>(0,f._)("div",{class:"loader"},null,-1)));function N(t,e,a,s,o,l){const n=(0,f.up)("loading");return(0,f.wg)(),(0,f.iD)("div",P,[(0,f.Wm)(n,{active:o.status,"can-cancel":!0,"is-full-page":o.fullPage},{default:(0,f.w5)((()=>[Z])),_:1},8,["active","is-full-page"])])}var A={data(){return{status:!1,fullPage:!0}},components:{Loading:d()},mounted(){this.$emitter.on("loadingStatus",(t=>{this.status=t}))}};const j=(0,S.Z)(A,[["render",N],["__scopeId","data-v-5de688a9"]]);var z=j;const T={class:"modal fade",ref:"message",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},F={class:"modal-dialog"};function q(t,e,a,s,o,l){return(0,f.wg)(),(0,f.iD)("div",T,[(0,f._)("div",F,[(0,f._)("div",{class:(0,_.C_)(["alert border-2 rounded-0",[o.status?"alert-dark border-dark":"alert-danger border-danger"]])},[(0,f._)("i",{class:(0,_.C_)(["bi me-2",[o.status?"bi-check-square":"bi-exclamation-triangle"]])},null,2),(0,f.Uk)((0,_.zw)(o.message),1)],2)])],512)}var H={data(){return{messageModal:"",message:"",status:!1}},methods:{openModal(){this.messageModal.toggle()}},mounted(){this.messageModal=new u.u_(this.$refs.message),this.$emitter.on("messageModal",(t=>{this.status=t.status,this.message=t.message,this.openModal()}))}};const R=(0,S.Z)(H,[["render",q]]);var J=R;const Y={class:"modal fade",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"workRecordModal"},K={class:"modal-dialog modal-fullscreen-xl-down"},B={class:"modal-content"},G=(0,f._)("div",{class:"modal-header"},[(0,f._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Q={class:"modal-body"},X={class:"table table-striped"},tt=(0,f._)("thead",null,[(0,f._)("tr",null,[(0,f._)("th",{scope:"col"},"#"),(0,f._)("th",{scope:"col"},"工程名稱"),(0,f._)("th",{scope:"col"},"日期"),(0,f._)("th",{scope:"col"},"時數")])],-1),et={scope:"row"},at=["onClick"],st=(0,f._)("td",{colspan:"3"},"總累積時數：",-1),ot={key:0},lt={class:"row g-3"},nt={class:"col-md-6"},it=(0,f._)("label",{for:"inputEmail4",class:"form-label"},"廠商名稱",-1),rt={class:"col-md-6"},dt=(0,f._)("label",{for:"inputPassword4",class:"form-label"},"負責人",-1),mt={class:"col-12"},ut=(0,f._)("label",{for:"inputAddress",class:"form-label"},"施工地址",-1),ct={class:"col-md-6"},pt=(0,f._)("label",{for:"inputAddress2",class:"form-label"},"工程日期",-1),ht={class:"col-md-6"},ft={key:0},bt={key:1};function gt(t,e,a,o,l,n){return(0,f.wg)(),(0,f.iD)("div",Y,[(0,f._)("div",K,[(0,f._)("div",B,[G,(0,f._)("div",Q,[(0,f._)("table",X,[tt,(0,f._)("tbody",null,[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(l.tempData,((t,e)=>((0,f.wg)(),(0,f.iD)("tr",{key:e},[(0,f._)("th",et,(0,_.zw)(e+1),1),(0,f._)("td",null,[(0,f._)("button",{class:"btn btn-dark",onClick:e=>n.getOrder(t._id)},(0,_.zw)(t._id),9,at)]),(0,f._)("td",null,(0,_.zw)(t.constructionDate),1),(0,f._)("td",null,(0,_.zw)(t.time),1)])))),128)),(0,f._)("tr",null,[st,(0,f._)("td",null,(0,_.zw)(l.times),1)])])]),l.tempOrder?((0,f.wg)(),(0,f.iD)("div",ot,[(0,f._)("form",lt,[(0,f._)("div",nt,[it,(0,f.wy)((0,f._)("input",{type:"text",class:"form-control",id:"inputEmail4",disabled:"","onUpdate:modelValue":e[0]||(e[0]=t=>l.tempOrder.company.companyName=t)},null,512),[[s.nr,l.tempOrder.company.companyName]])]),(0,f._)("div",rt,[dt,(0,f.wy)((0,f._)("input",{type:"text",class:"form-control",id:"inputPassword4","onUpdate:modelValue":e[1]||(e[1]=t=>l.tempOrder.company.name=t),disabled:""},null,512),[[s.nr,l.tempOrder.company.name]])]),(0,f._)("div",mt,[ut,(0,f.wy)((0,f._)("input",{type:"text",class:"form-control",id:"inputAddress","onUpdate:modelValue":e[2]||(e[2]=t=>l.tempOrder.address=t),disabled:""},null,512),[[s.nr,l.tempOrder.address]])]),(0,f._)("div",ct,[pt,(0,f.wy)((0,f._)("input",{type:"text",class:"form-control",id:"inputAddress2",disabled:"","onUpdate:modelValue":e[3]||(e[3]=t=>l.tempOrder.constructionDate=t)},null,512),[[s.nr,l.tempOrder.constructionDate]])]),(0,f._)("div",ht,[(0,f._)("button",{class:(0,_.C_)(["btn",[l.tempOrder.status?"btn-outline-success":"btn-outline-danger"]]),disabled:""},[l.tempOrder.status?((0,f.wg)(),(0,f.iD)("span",ft,"完工")):((0,f.wg)(),(0,f.iD)("span",bt,"未完工"))],2)])])])):(0,f.kq)("",!0)])])])],512)}var _t=a(5044),yt={data(){return{modal:"",tempData:"",times:0,tempOrder:""}},methods:{getOrder(t){this.$emitter.emit("loadingStatus",!0),(0,_t.IP)(t).then((t=>{this.$emitter.emit("loadingStatus",!1),this.tempOrder=t.data.data})).catch((t=>{console.log(t),this.$emitter.emit("loadingStatus",!1)}))},getWorkerList(t){this.$emitter.emit("loadingStatus",!0),(0,_t.B1)(t).then((t=>{this.tempData=t.data.data,this.$emitter.emit("loadingStatus",!1),this.totalTime()})).catch((t=>{console.log(t),this.$emitter.emit("loadingStatus",!0)}))},totalTime(){this.times=0,this.tempData.forEach((t=>{this.times+=t.time}))},showModal(){this.modal.show()}},mounted(){this.modal=new u.u_(this.$refs.workRecordModal),this.$emitter.on("workerList",(t=>{this.tempOrder="",this.getWorkerList(t),this.showModal()}))}};const vt=(0,S.Z)(yt,[["render",gt]]);var kt=vt;const wt={class:"modal fade",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"pdfModal"},Dt={class:"modal-dialog modal-xl"},xt={class:"modal-content"},$t=(0,f._)("div",{class:"modal-header"},[(0,f._)("h1",{class:"modal-title fs-5"},"Modal title"),(0,f._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Wt={class:"modal-body"},Mt={ref:"pdf",class:"px-5 py-0"},Vt=(0,f._)("h1",{class:"text-center mb-5"},"工程承攬合約書",-1),Ct={class:"h4 d-flex ms-5 mb-5"},Ut=(0,f._)("div",null,"立合約書人：",-1),Ot={class:"d-flex flex-column"},St=(0,f._)("div",{class:"mb-3"},"業主＿＿＿公司(以下稱甲方)",-1),Lt={class:"text-info px-3 text-decoration-underline"},Et=(0,f._)("div",{class:"h4 mb-5"}," 茲因乙方承包甲方______工程，雙方同意訂定合約條款如下，以資互相遵守: ",-1),It={class:"list-unstyled h5 mb-5"},Pt={class:"mb-4"},Zt={class:"text-info px-3 text-decoration-underline"},Nt=(0,f._)("li",{class:"mb-4"}," 二、 工程圖說明:乙方應按經甲方認可之設計圖說規格切實施工。(圖說如附件) ",-1),At=(0,f._)("li",{class:"mb-4"}," 三、 工程材料:本工程須按設計圖及施工說明書中所註明之材料施工，甲方得隨時派人監工。 ",-1),jt=(0,f._)("li",{class:"mb-4"}," 四、 施工期限:自民國 年 月 日起至民國 年 月 日止， 共計 工作天。 ",-1),zt={class:"mb-4"},Tt={class:"text-info px-3 text-decoration-underline"},Ft=(0,f.uE)('<li class="mb-4"> 六、 付款辦法: <ul class="list-unstyled ps-5"><li class="mb-2"> (1)本契約訂定之日給付工程總價三○%計新台幣__元整。 </li><li class="mb-2"> (2)工程完成四成時給付工程總價四○%計新台幣__元整。 </li><li class="mb-2"> (3)工程完成八成時給付工程總價二五%計新台幣__元整。 </li><li class="mb-2">(4)工程完成驗收後付清工程尾款。</li><li class="mb-2">(5)付款方式以現款付之。</li><li class="mb-2"> (6)上列四項付款期限如甲方故意遲延給付時，乙方對以後工程得自動停止 進行。其停止期間不計入第四條之施工期限內。 </li></ul></li><li class="mb-4"><div class="d-flex"><div class="text-nowrap">七、 工程變更:</div><div> 甲方認為本工程其中部份有變更之必要時，得通知乙方辦理，因 工程變更而有數量之增減時，其工程費之計算，仍以估價單內所 列單價為準，如有新增項目，應由雙方共同議定合理之單價。是 項增減工程價款及付款方式經雙方議定後，用書面附入本合約內 作為附件。 </div></div></li><li class="mb-4"> 八、 工程意外: <ul class="list-unstyled ps-4"><li class="mb-2"> (1) 本工程進行中因乙方之疏忽及過失，以致損害他人之身體或財產時，乙 方應付賠償責任。但因不可抗力之損失者不在此限。 </li><li> (2) 施工期間如遇天災地變等非人為因素之變故，亦不在此限。 </li></ul></li><li class="mb-4"><div class="d-flex"><div class="text-nowrap">九、 工程配合:</div><div> 本工程由甲方供給之材料或他包之配合工程，如未能按期供應或 未能按期施工，致使乙方之工程進度滯緩時，得依遲緩日數延長 本工程施工期限。 </div></div></li><li class="mb-4"><div class="d-flex"><div class="text-nowrap">十、 工程驗收:</div><div>工程完成後，甲方應於三天內驗收完畢，不得拖延。</div></div></li>',5),qt=(0,f.uE)('<div class="h4 mb-2"> 本契約壹式貳份，由甲乙雙方各執乙份為憑。 </div><div class="h4 mb-5"> 如有未盡事宜，雙方以誠實合理商獲協議以書面補充之。 </div><div class="h4 mb-5"><div class="mb-3 h3">業主(即甲方)</div><div class="mb-3">公司名稱:</div><div class="mb-3">代表人:</div><div class="mb-3">統一編號:</div><div class="mb-3">地址:</div><div class="mb-3">電話:</div></div>',3),Ht={class:"h4 mb-5"},Rt=(0,f._)("div",{class:"mb-3 h3"},"承包商(即乙方)",-1),Jt={class:"mb-3"},Yt={class:"ms-2 fw-bolder text-info"},Kt={class:"mb-3"},Bt={class:"ms-2 fw-bolder text-info"},Gt={class:"mb-3"},Qt={class:"ms-2 fw-bolder text-info"},Xt={class:"mb-3"},te={class:"ms-2 fw-bolder text-info"},ee={class:"mb-3"},ae={class:"ms-2 fw-bolder text-info"},se=(0,f.uE)('<div class="text-center h3 text-nowrap"><span class="mx-5">中</span><span class="mx-5">華</span><span class="mx-5">民</span><span class="mx-5">國</span><span class="mx-5">年</span><span class="mx-5">月</span><span class="mx-5">日</span></div><div class="text-nowrap text-center h6">_</div>',2),oe={class:"modal-footer"};function le(t,e,a,s,o,l){return(0,f.wg)(),(0,f.iD)("div",wt,[(0,f._)("div",Dt,[(0,f._)("div",xt,[$t,(0,f._)("div",Wt,[(0,f._)("section",null,[(0,f._)("div",Mt,[Vt,(0,f._)("div",Ct,[Ut,(0,f._)("div",Ot,[St,(0,f._)("div",null,[(0,f.Uk)(" 承包商"),(0,f._)("span",Lt,(0,_.zw)(o.tempCompany.companyName),1),(0,f.Uk)("公司(以下稱乙方) ")])])]),Et,(0,f._)("ul",It,[(0,f._)("li",Pt,[(0,f.Uk)(" 一、 工程位置:本件工程座落於 "),(0,f._)("span",Zt,(0,_.zw)(o.tempData.address),1)]),Nt,At,jt,(0,f._)("li",zt,[(0,f.Uk)(" 五、 工程總價:新台幣"),(0,f._)("span",Tt,(0,_.zw)(o.tempData.total),1),(0,f.Uk)("元整。 ")]),Ft]),qt,(0,f._)("div",Ht,[Rt,(0,f._)("div",Jt,[(0,f.Uk)(" 公司名稱:"),(0,f._)("span",Yt,(0,_.zw)(o.tempCompany.companyName),1)]),(0,f._)("div",Kt,[(0,f.Uk)(" 代表人:"),(0,f._)("span",Bt,(0,_.zw)(o.tempCompany.name),1)]),(0,f._)("div",Gt,[(0,f.Uk)(" 統一編號:"),(0,f._)("span",Qt,(0,_.zw)(o.tempCompany.taxIdNumber),1)]),(0,f._)("div",Xt,[(0,f.Uk)(" 地址:"),(0,f._)("span",te,(0,_.zw)(o.tempCompany.address),1)]),(0,f._)("div",ee,[(0,f.Uk)(" 電話:"),(0,f._)("span",ae,(0,_.zw)(o.tempCompany.taxIdNumber),1)])]),se],512)])]),(0,f._)("div",oe,[(0,f._)("button",{class:"btn btn-dark",onClick:e[0]||(e[0]=t=>l.download())},"Download PDF")])])])],512)}var ne=a(4730),ie=a(1120),re={data(){return{pdfModal:"",tempData:{},tempCompany:{}}},methods:{download(){const t=595.28,e=841.89;ie(this.$refs.pdf,{scale:2,useCORS:!0,backgroundColor:"#fff"}).then((a=>{const s=a.width/t*e;let o=a.height,l=0;const n=t,i=t/a.width*a.height,r=a.toDataURL("image/jpeg",1),d=new ne.kH("p","pt","a4");if(o<s)d.addImage(r,"JPEG",0,0,n,i);else while(o>0)d.addImage(r,"JPEG",0,l,n,i),o-=s,l-=e,o>0&&d.addPage();d.save("test.pdf")}))},showModal(){this.pdfModal.show()}},mounted(){this.pdfModal=new u.u_(this.$refs.pdfModal),this.$emitter.on("pdfEmit",(t=>{this.tempData=t,this.tempCompany=this.tempData.company,this.showModal()}))}};const de=(0,S.Z)(re,[["render",le]]);var me=de;const ue={class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"AddEdit"},ce={class:"modal-dialog"},pe={class:"modal-content"},he={class:"modal-header"},fe={class:"modal-title fs-5",id:"exampleModalLabel"},be={key:0},ge={key:1},_e={class:"modal-body"},ye={class:"form-floating mb-3"},ve={for:"floatingInput"},ke={class:"form-floating mb-3"},we={for:"floatingInput"},De={class:"form-floating mb-3"},xe={for:"phone"},$e={class:"form-floating mb-3"},We={for:"floatingInput"},Me={class:"form-floating mb-3"},Ve={for:"floatingInput"},Ce={class:"modal-footer justify-content-between"},Ue=(0,f._)("div",null,null,-1),Oe=["disabled"];function Se(t,e,a,s,o,l){const n=(0,f.up)("VField"),i=(0,f.up)("ErrorMessage"),r=(0,f.up)("error-message"),d=(0,f.up)("VForm");return(0,f.wg)(),(0,f.iD)("div",ue,[(0,f._)("div",ce,[(0,f._)("div",pe,[(0,f._)("div",he,[(0,f._)("h1",fe,[o.status?((0,f.wg)(),(0,f.iD)("span",be,"新增公司")):((0,f.wg)(),(0,f.iD)("span",ge,"修改公司"))]),(0,f._)("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=(...t)=>l.hideModal&&l.hideModal(...t)),"aria-label":"Close"})]),(0,f.Wm)(d,{ref:"formRefSignin",id:"profileForm",onSubmit:l.addEditCompany},{default:(0,f.w5)((({errors:t,meta:a})=>[(0,f._)("div",_e,[(0,f._)("div",ye,[(0,f.Wm)(n,{name:"廠商",type:"text",rules:"required",class:"form-control",modelValue:o.tempData.companyName,"onUpdate:modelValue":e[1]||(e[1]=t=>o.tempData.companyName=t)},null,8,["modelValue"]),(0,f._)("label",ve,[(0,f.Uk)("廠商名稱"),(0,f.Wm)(i,{name:"廠商",class:"text-danger ms-3"})])]),(0,f._)("div",ke,[(0,f.Wm)(n,{name:"負責人",type:"text",rules:"required",class:"form-control",modelValue:o.tempData.name,"onUpdate:modelValue":e[2]||(e[2]=t=>o.tempData.name=t)},null,8,["modelValue"]),(0,f._)("label",we,[(0,f.Uk)("負責人名稱"),(0,f.Wm)(i,{name:"負責人",class:"text-danger ms-3"})])]),(0,f._)("div",De,[(0,f.Wm)(n,{id:"phone",name:"phone",type:"text",class:(0,_.C_)(["form-control",{"is-invalid":t["電話"]}]),rules:l.isPhone,modelValue:o.tempData.phone,"onUpdate:modelValue":e[3]||(e[3]=t=>o.tempData.phone=t)},null,8,["class","rules","modelValue"]),(0,f._)("label",xe,[(0,f.Uk)("phone"),(0,f.Wm)(r,{name:"phone",class:"text-danger ms-3"})])]),(0,f._)("div",$e,[(0,f.Wm)(n,{name:"統一編號",class:"form-control",type:"text",rules:{regex:/^[0-9]{8}$/},modelValue:o.tempData.taxIdNumber,"onUpdate:modelValue":e[4]||(e[4]=t=>o.tempData.taxIdNumber=t)},null,8,["modelValue"]),(0,f._)("label",We,[(0,f.Uk)("統一編號"),(0,f.Wm)(i,{name:"統一編號",class:"ms-3 text-danger"})])]),(0,f._)("div",Me,[(0,f.Wm)(n,{name:"地址",type:"text",modelValue:o.tempData.address,"onUpdate:modelValue":e[5]||(e[5]=t=>o.tempData.address=t),class:"form-control"},null,8,["modelValue"]),(0,f._)("label",Ve,[(0,f.Uk)("地址"),(0,f.Wm)(i,{name:"地址",class:"text-danger ms-3"})])])]),(0,f._)("div",Ce,[o.status?(0,f.kq)("",!0):((0,f.wg)(),(0,f.iD)("button",{key:0,type:"button",class:"btn btn-outline-danger",onClick:e[6]||(e[6]=(...t)=>l.deleteCompany&&l.deleteCompany(...t))}," 刪除廠商資料 ")),Ue,(0,f._)("button",{type:"submit",class:"btn btn-primary",disabled:!a.valid},"儲存",8,Oe)])])),_:1},8,["onSubmit"])])])],512)}var Le={data(){return{modal:"",status:!1,tempData:{companyName:"",name:"",phone:"",taxIdNumber:"",address:""}}},methods:{isPhone(t){const e=/^(09)[0-9]{8}$/;return!!e.test(t)||"需要正確的電話號碼"},addEditCompany(){this.$emitter.emit("loadingStatus",!0),this.tempData._id?(0,_t.Ck)(this.tempData).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"修改成功"}),this.$emitter.emit("getCompanyLsit"),this.$emitter.emit("loadingStatus",!1),this.hideModal()})).catch((t=>{this.$emitter.emit("messageModal",{status:!1,message:t.response.data.message}),this.$emitter.emit("loadingStatus",!1)})):(0,_t.yb)(this.tempData).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"新增成功"}),this.$emitter.emit("getCompanyLsit"),this.$emitter.emit("loadingStatus",!1),this.hideModal()})).catch((t=>{this.$emitter.emit("messageModal",{status:!1,message:t.response.data.message}),this.$emitter.emit("loadingStatus",!1)}))},deleteCompany(){const t=prompt(`輸入該廠商ＩＤ：${this.tempData._id}`,"");t===this.tempData._id&&(0,_t.Jh)(this.tempData._id).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"刪除成功"}),this.$emitter.emit("getCompanyLsit"),this.$emitter.emit("loadingStatus",!1),this.hideModal()})).catch((t=>{this.$emitter.emit("messageModal",{status:!1,message:t.response.data.message}),this.$emitter.emit("loadingStatus",!1)}))},showModal(){this.modal.show()},hideModal(){this.tempData={},this.modal.hide()}},mounted(){this.modal=new u.u_(this.$refs.AddEdit),this.$emitter.on("addEditCom",(t=>{this.status=t.status,t.status||(this.tempData=JSON.parse(JSON.stringify(t.data))),this.showModal()}))}};const Ee=(0,S.Z)(Le,[["render",Se]]);var Ie=Ee;const Pe={class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"AddEdit"},Ze={class:"modal-dialog modal-xl"},Ne={class:"modal-content"},Ae={class:"modal-header"},je={class:"modal-title fs-5",id:"exampleModalLabel"},ze={key:0},Te={key:1},Fe={class:"modal-body row row-cols-2"},qe={class:"form-floating mb-3"},He={id:"datalistOptions"},Re=["value"],Je={for:"floatingInput"},Ye={class:"form-floating mb-3"},Ke={for:"floatingInput"},Be={class:"form-floating mb-3"},Ge={for:"floatingInput"},Qe={class:"form-floating mb-3"},Xe=(0,f._)("option",{value:"現金"},"現金",-1),ta=(0,f._)("option",{value:"支票"},"支票",-1),ea={for:"floatingInput"},aa={class:"form-floating mb-3"},sa={for:"floatingInput"},oa={class:"form-floating mb-3"},la={for:"floatingInput"},na=(0,f._)("h5",null,"工人：",-1),ia={key:0},ra={class:"form-floating mb-3"},da={class:"row row-cols-3 row-cols-md-4 g-3 mb-3"},ma=["value","id"],ua=["for"],ca=["value"],pa=["value"],ha=["onUpdate:modelValue"],fa={key:1},ba=["onUpdate:modelValue"],ga=["onUpdate:modelValue"],_a=["onUpdate:modelValue"],ya=(0,f._)("hr",null,null,-1),va=(0,f._)("h5",null,"調用工人：",-1),ka=["onUpdate:modelValue"],wa=["onUpdate:modelValue"],Da=["onUpdate:modelValue"],xa=["onClick"],$a={class:"d-flex justify-content-center"},Wa={class:"modal-footer justify-content-between"},Ma=(0,f._)("div",null,null,-1),Va=["disabled"];function Ca(t,e,a,o,l,n){const i=(0,f.up)("VField"),r=(0,f.up)("ErrorMessage"),d=(0,f.up)("VForm");return(0,f.wg)(),(0,f.iD)("div",Pe,[(0,f._)("div",Ze,[(0,f._)("div",Ne,[(0,f._)("div",Ae,[(0,f._)("h1",je,[l.status?((0,f.wg)(),(0,f.iD)("span",ze,"新增工單")):((0,f.wg)(),(0,f.iD)("span",Te,"修改工單"))]),(0,f._)("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=(...t)=>n.hideModal&&n.hideModal(...t)),"aria-label":"Close"})]),(0,f.Wm)(d,{ref:"formRefSignin",id:"profileForm",onSubmit:n.addEditOrder},{default:(0,f.w5)((({meta:a})=>[(0,f._)("div",Fe,[(0,f._)("section",null,[(0,f._)("div",qe,[(0,f.Wm)(i,{name:"廠商",type:"text",rules:n.isCompanyExist,class:"form-control",list:"datalistOptions"},null,8,["rules"]),(0,f._)("datalist",He,[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(l.companyList,((t,e)=>((0,f.wg)(),(0,f.iD)("option",{key:e,value:t.companyName},null,8,Re)))),128))]),(0,f._)("label",Je,[(0,f.Uk)("廠商名稱"),(0,f.Wm)(r,{name:"廠商",class:"text-danger ms-3"})])]),(0,f._)("div",Ye,[(0,f.Wm)(i,{name:"施工地址",rules:"required",type:"text",modelValue:l.tempData.address,"onUpdate:modelValue":e[1]||(e[1]=t=>l.tempData.address=t),class:"form-control"},null,8,["modelValue"]),(0,f._)("label",Ke,[(0,f.Uk)("施工地址"),(0,f.Wm)(r,{name:"施工地址",class:"text-danger ms-3"})])]),(0,f._)("div",Be,[(0,f.Wm)(i,{name:"施工日期",rules:"required",type:"date",modelValue:l.tempData.constructionDate,"onUpdate:modelValue":e[2]||(e[2]=t=>l.tempData.constructionDate=t),class:"form-control"},null,8,["modelValue"]),(0,f._)("label",Ge,[(0,f.Uk)("施工日期"),(0,f.Wm)(r,{name:"施工日期",class:"text-danger ms-3"})])]),(0,f._)("div",Qe,[(0,f.Wm)(i,{name:"付款方式",as:"select",rules:"required",class:"form-control",modelValue:l.tempData.paymentMethod,"onUpdate:modelValue":e[3]||(e[3]=t=>l.tempData.paymentMethod=t)},{default:(0,f.w5)((()=>[Xe,ta])),_:1},8,["modelValue"]),(0,f._)("label",ea,[(0,f.Uk)("付款方式"),(0,f.Wm)(r,{name:"付款方式",class:"text-danger ms-3"})])]),(0,f._)("div",aa,[(0,f.Wm)(i,{name:"總金額",type:"number",rules:"required",modelValue:l.tempData.total,"onUpdate:modelValue":e[4]||(e[4]=t=>l.tempData.total=t),class:"form-control"},null,8,["modelValue"]),(0,f._)("label",sa,[(0,f.Uk)("總金額"),(0,f.Wm)(r,{name:"總金額",class:"text-danger ms-3"})])]),(0,f._)("div",oa,[(0,f.Wm)(i,{name:"保留款",type:"number",modelValue:l.tempData.retainage,"onUpdate:modelValue":e[5]||(e[5]=t=>l.tempData.retainage=t),class:"form-control"},null,8,["modelValue"]),(0,f._)("label",la,[(0,f.Uk)("保留款"),(0,f.Wm)(r,{name:"保留款",class:"text-danger ms-3"})])])]),(0,f._)("section",null,[na,l.status?((0,f.wg)(),(0,f.iD)("div",ia,[(0,f._)("div",ra,[(0,f._)("div",da,[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(l.workerList,((t,a)=>((0,f.wg)(),(0,f.iD)("div",{class:"form-check",key:a},[(0,f.wy)((0,f._)("input",{class:"form-check-input",type:"checkbox",value:t,id:`worker${a}`,"onUpdate:modelValue":e[6]||(e[6]=t=>l.tempData.workers=t)},null,8,ma),[[s.e8,l.tempData.workers]]),(0,f._)("label",{class:"form-check-label",for:`worker${a}`},(0,_.zw)(t.name),9,ua)])))),128))])]),((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(l.tempData.workers,((t,e)=>((0,f.wg)(),(0,f.iD)("div",{key:e,class:"input-group mb-2"},[(0,f._)("input",{type:"text",placeholder:"工人姓名",class:"form-control",value:t.name,disabled:""},null,8,ca),(0,f._)("input",{type:"text",placeholder:"工人電話",class:"form-control",value:t.phone,disabled:""},null,8,pa),(0,f.wy)((0,f._)("input",{type:"number",placeholder:"工作時數",class:"form-control","onUpdate:modelValue":t=>l.tempData.workers[e].time=t},null,8,ha),[[s.nr,l.tempData.workers[e].time]])])))),128))])):((0,f.wg)(),(0,f.iD)("div",fa,[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(l.tempData.workers,((t,e)=>((0,f.wg)(),(0,f.iD)("div",{key:e,class:"input-group mb-2"},[(0,f.wy)((0,f._)("input",{type:"text",placeholder:"工人姓名",class:"form-control","onUpdate:modelValue":e=>t._id.name=e,disabled:""},null,8,ba),[[s.nr,t._id.name]]),(0,f.wy)((0,f._)("input",{type:"text",placeholder:"工人電話",class:"form-control","onUpdate:modelValue":e=>t._id.phone=e,disabled:""},null,8,ga),[[s.nr,t._id.phone]]),(0,f.wy)((0,f._)("input",{type:"number",placeholder:"工作時數",class:"form-control","onUpdate:modelValue":t=>l.tempData.workers[e].time=t},null,8,_a),[[s.nr,l.tempData.workers[e].time]])])))),128))])),ya,(0,f._)("div",null,[va,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(l.tempData.transferWorkers,((t,e)=>((0,f.wg)(),(0,f.iD)("div",{key:e,class:"input-group mb-2"},[(0,f.wy)((0,f._)("input",{type:"text",placeholder:"工人姓名",class:"form-control","onUpdate:modelValue":t=>l.tempData.transferWorkers[e].name=t},null,8,ka),[[s.nr,l.tempData.transferWorkers[e].name]]),(0,f.wy)((0,f._)("input",{type:"text","aria-label":"Last name",placeholder:"工人電話",class:"form-control","onUpdate:modelValue":t=>l.tempData.transferWorkers[e].phone=t},null,8,wa),[[s.nr,l.tempData.transferWorkers[e].phone]]),(0,f.wy)((0,f._)("input",{type:"number","aria-label":"Last name",placeholder:"工作時數",class:"form-control","onUpdate:modelValue":t=>l.tempData.transferWorkers[e].time=t},null,8,Da),[[s.nr,l.tempData.transferWorkers[e].time]]),(0,f._)("button",{class:"btn btn-outline-danger",type:"button",id:"button-add",onClick:t=>n.deleteTransArray(e)}," 刪除 ",8,xa)])))),128)),(0,f._)("div",$a,[(0,f._)("button",{class:"btn btn-outline-dark",type:"button",onClick:e[7]||(e[7]=(...t)=>n.addTransArray&&n.addTransArray(...t))}," 新增 ")])])])]),(0,f._)("div",Wa,[l.status?(0,f.kq)("",!0):((0,f.wg)(),(0,f.iD)("button",{key:0,type:"button",class:"btn btn-outline-danger",onClick:e[8]||(e[8]=e=>t.deleteOrder(l.tempData._id))}," 刪除該工單 ")),Ma,(0,f._)("button",{type:"submit",class:"btn btn-primary",disabled:!a.valid}," 儲存 ",8,Va)])])),_:1},8,["onSubmit"])])])],512)}var Ua={data(){return{modal:"",status:!1,tempData:{address:"",company:"",status:0,paymentMethod:"",total:0,retainage:0,constructionDate:"",workers:[],transferWorkers:[]},tempWorker:[],companyList:[],workerList:[]}},watch:{},methods:{isCompanyExist(t){this.tempData.company="";let e="";return this.companyList.forEach((a=>{a.companyName===t&&(e=a.company,this.tempData.company=a._id)})),""!==e||"查無此廠商"},getCompany(){(0,_t.rO)().then((t=>{this.companyList=t.data.data})).catch((t=>{console.log(t)}))},getWorker(){(0,_t.mL)().then((t=>{this.workerList=t.data.data})).catch((t=>{console.log(t)}))},addEditOrder(){this.tempData._id?console.log("這是修改"):(0,_t.Vh)(this.tempData).then((t=>{console.log(t)})).catch((t=>{console.log(t)}))},addTransArray(){this.tempData.transferWorkers.push({})},deleteTransArray(t){this.tempData.transferWorkers.splice(t,1)},showModal(){this.modal.show()},hideModal(){this.tempData={address:"",company:"",status:0,paymentMethod:"",total:0,retainage:0,constructionDate:"",workers:[],transferWorkers:[]},this.modal.hide()}},mounted(){this.getCompany(),this.getWorker(),this.modal=new u.u_(this.$refs.AddEdit),this.$emitter.on("addEditOrder",(t=>{this.status=t.status,t.status||(this.tempData=JSON.parse(JSON.stringify(t.data))),this.showModal()}))}};const Oa=(0,S.Z)(Ua,[["render",Ca]]);var Sa=Oa;const La={class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"addEditWorker"},Ea={class:"modal-dialog"},Ia={class:"modal-content"},Pa={class:"modal-header"},Za={class:"modal-title fs-5",id:"exampleModalLabel"},Na={key:0},Aa={key:1},ja={class:"modal-body"},za={class:"form-floating mb-3"},Ta={for:"floatingInput"},Fa={class:"form-floating mb-3"},qa={for:"phone"},Ha={class:"form-floating mb-3"},Ra={for:"floatingInput"},Ja={class:"input-group mb-3"},Ya=(0,f._)("label",{for:"imageFront",class:"input-group-text"},"上傳身分證或居留證正面",-1),Ka=(0,f._)("div",{class:"input-group mb-3"},[(0,f._)("input",{type:"file",class:"form-control",accept:"image/*",id:"imageBack",name:"image"}),(0,f._)("label",{for:"imageBack",class:"input-group-text"},"上傳身分證或居留證反面")],-1),Ba={class:"input-group mb-3"},Ga=(0,f._)("label",{class:"input-group-text",for:"inputGroupSelect01"},"員工職別",-1),Qa=(0,f._)("option",{value:"工人",selected:""},"工人",-1),Xa=(0,f._)("option",{value:"監工"},"監工",-1),ts=(0,f._)("option",{value:"工地主任"},"工地主任",-1),es=(0,f._)("option",{value:"工頭"},"工頭",-1),as=[Qa,Xa,ts,es],ss={class:"input-group mb-3"},os=(0,f._)("label",{for:"date",class:"input-group-text"},"入職日期",-1),ls={class:"form-floating mb-3"},ns={for:"floatingInput"},is={class:"modal-footer justify-content-between"},rs=(0,f._)("div",null,null,-1),ds=["disabled"];function ms(t,e,a,o,l,n){const i=(0,f.up)("VField"),r=(0,f.up)("ErrorMessage"),d=(0,f.up)("error-message"),m=(0,f.up)("VForm");return(0,f.wg)(),(0,f.iD)("div",La,[(0,f._)("div",Ea,[(0,f._)("div",Ia,[(0,f._)("div",Pa,[(0,f._)("h1",Za,[l.status?((0,f.wg)(),(0,f.iD)("span",Na,"新增員工")):((0,f.wg)(),(0,f.iD)("span",Aa,"修改員工"))]),(0,f._)("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=(...t)=>n.hideModal&&n.hideModal(...t)),"aria-label":"Close"})]),(0,f.Wm)(m,{ref:"formRefSignin",id:"profileForm",onSubmit:n.addEditWorker},{default:(0,f.w5)((({errors:a,meta:o})=>[(0,f._)("div",ja,[(0,f._)("div",za,[(0,f.Wm)(i,{name:"姓名",type:"text",rules:"required",class:"form-control",modelValue:l.tempData.name,"onUpdate:modelValue":e[1]||(e[1]=t=>l.tempData.name=t)},null,8,["modelValue"]),(0,f._)("label",Ta,[(0,f.Uk)("員工姓名 "),(0,f.Wm)(r,{name:"姓名",class:"text-danger ms-3"})])]),(0,f._)("div",Fa,[(0,f.Wm)(i,{id:"phone",name:"phone",type:"text",class:(0,_.C_)(["form-control",{"is-invalid":a["電話"]}]),rules:n.isPhone,modelValue:l.tempData.phone,"onUpdate:modelValue":e[2]||(e[2]=t=>l.tempData.phone=t)},null,8,["class","rules","modelValue"]),(0,f._)("label",qa,[(0,f.Uk)("phone"),(0,f.Wm)(d,{name:"phone",class:"text-danger ms-3"})])]),(0,f._)("div",Ha,[(0,f.Wm)(i,{name:"身分證字號或居留證",class:"form-control",type:"text",rules:{regex:/^[A-Z]{1}[1-2]{1}[0-9]{8}$/},modelValue:l.tempData.idNumber,"onUpdate:modelValue":e[3]||(e[3]=t=>l.tempData.idNumber=t)},null,8,["modelValue"]),(0,f._)("label",Ra,[(0,f.Uk)("身分證字號或居留證 "),(0,f.Wm)(r,{name:"身分證字號或居留證",class:"ms-3 text-danger"})])]),(0,f._)("div",Ja,[(0,f._)("input",{class:"form-control",type:"file",accept:"image/*",id:"imageFront",name:"image",onChange:e[4]||(e[4]=(...e)=>t.uploadImage&&t.uploadImage(...e))},null,32),Ya]),Ka,(0,f._)("div",Ba,[Ga,(0,f.wy)((0,f._)("select",{class:"form-select",id:"inputGroupSelect01","onUpdate:modelValue":e[5]||(e[5]=t=>l.tempData.position=t)},as,512),[[s.bM,l.tempData.position]])]),(0,f._)("div",ss,[os,(0,f.wy)((0,f._)("input",{id:"date",name:"date",type:"date",placeholder:"Enter email",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=t=>l.tempData.seniority=t)},null,512),[[s.nr,l.tempData.seniority]])]),(0,f._)("div",ls,[(0,f.Wm)(i,{name:"時薪",type:"text",modelValue:l.tempData.hourlyRate,"onUpdate:modelValue":e[7]||(e[7]=t=>l.tempData.hourlyRate=t),rules:{regex:/^(([^0][0-9]+|0)\.([0-9])$)|^(([^0][0-9]+|0)$)|^(([1-9]+)\.([0-9])$)|^(([1-9]+)$)/},class:"form-control"},null,8,["modelValue","rules"]),(0,f._)("label",ns,[(0,f.Uk)("時薪 "),(0,f.Wm)(r,{name:"時薪",class:"text-danger ms-3"})])])]),(0,f._)("div",is,[l.status?(0,f.kq)("",!0):((0,f.wg)(),(0,f.iD)("button",{key:0,type:"button",class:"btn btn-outline-danger",onClick:e[8]||(e[8]=(...t)=>n.deleteProfile&&n.deleteProfile(...t))}," 刪除員工資料 ")),rs,(0,f._)("button",{type:"submit",class:"btn btn-primary",disabled:!o.valid}," Save changes ",8,ds)])])),_:1},8,["onSubmit"])])])],512)}var us={data(){return{modal:"",status:!1,tempData:{name:"",phone:"",idNumber:"",imageFront:"",imageBack:"",seniority:"",hourlyRate:0,position:"工人",_id:""}}},methods:{isPhone(t){const e=/^(09)[0-9]{8}$/;return!!e.test(t)||"需要正確的電話號碼"},addEditWorker(){this.$emitter.emit("loadingStatus",!0),this.tempData._id?(0,_t.i3)(this.tempData).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"修改成功"}),this.$emitter.emit("getWorkerLsit"),this.$emitter.emit("loadingStatus",!1),this.hideModal()})).catch((t=>{console.log(t),this.$emitter.emit("loadingStatus",!1)})):(0,_t.nx)(this.tempData).then((t=>{console.log(t),this.$emitter.emit("messageModal",{status:!0,message:"新增成功"}),this.$emitter.emit("getWorkerLsit"),this.$emitter.emit("loadingStatus",!1),this.hideModal()})).catch((t=>{console.log(t),this.$emitter.emit("loadingStatus",!1)}))},deleteProfile(){this.$emitter.emit("loadingStatus",!0);const t=prompt(`輸入該用戶ＩＤ：${this.tempData._id}`,"");t===this.tempData._id?(0,_t.Mu)(this.tempData._id).then((t=>{console.log(t),this.$emitter.emit("messageModal",{status:!0,message:"刪除成功"}),this.$emitter.emit("loadingStatus",!1),this.$emitter.emit("getWorkerLsit"),this.hideModal()})).catch((t=>{console.log(t),this.$emitter.emit("messageModal",{status:!1,message:"刪除失敗"}),this.$emitter.emit("loadingStatus",!1)})):this.$emitter.emit("loadingStatus",!1)},showModal(){this.modal.show()},hideModal(){this.tempData={},this.modal.hide()}},mounted(){this.modal=new u.u_(this.$refs.addEditWorker),this.$emitter.on("addEditWorker",(t=>{this.status=t.status,t.status||(this.tempData=JSON.parse(JSON.stringify(t.data))),this.showModal()}))}};const cs=(0,S.Z)(us,[["render",ms]]);var ps=cs;const hs={class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"edit"},fs={class:"modal-dialog modal-xl"},bs={class:"modal-content"},gs={class:"modal-header"},_s={class:"modal-title fs-5",id:"exampleModalLabel"},ys={key:0},vs={key:1},ks={class:"modal-body row row-cols-2"},ws={class:"form-floating mb-3"},Ds={id:"datalistOptions"},xs=["value"],$s={for:"floatingInput"},Ws={class:"form-floating mb-3"},Ms={for:"floatingInput"},Vs={class:"form-floating mb-3"},Cs={for:"floatingInput"},Us={class:"form-floating mb-3"},Os=(0,f._)("option",{value:"現金"},"現金",-1),Ss=(0,f._)("option",{value:"支票"},"支票",-1),Ls={for:"floatingInput"},Es={class:"form-floating mb-3"},Is={for:"floatingInput"},Ps={class:"form-floating mb-3"},Zs={for:"floatingInput"},Ns=(0,f._)("h5",null,"工人：",-1),As={class:"form-floating mb-3"},js={class:"row row-cols-3 row-cols-md-5 g-3 mb-3"},zs=["onClick"],Ts=["onUpdate:modelValue"],Fs=["value"],qs=["onUpdate:modelValue"],Hs=(0,f._)("hr",null,null,-1),Rs=(0,f._)("h5",null,"調用工人：",-1),Js=["onUpdate:modelValue"],Ys=["onUpdate:modelValue"],Ks=["onUpdate:modelValue"],Bs=["onClick"],Gs={class:"d-flex justify-content-center"},Qs={class:"modal-footer justify-content-between"},Xs=(0,f._)("div",null,null,-1),to=["disabled"];function eo(t,e,a,o,l,n){const i=(0,f.up)("VField"),r=(0,f.up)("ErrorMessage"),d=(0,f.up)("VForm");return(0,f.wg)(),(0,f.iD)("div",hs,[(0,f._)("div",fs,[(0,f._)("div",bs,[(0,f._)("div",gs,[(0,f._)("h1",_s,[l.status?((0,f.wg)(),(0,f.iD)("span",ys,"新增工單")):((0,f.wg)(),(0,f.iD)("span",vs,"修改工單"))]),(0,f._)("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=(...t)=>n.hideModal&&n.hideModal(...t)),"aria-label":"Close"})]),(0,f.Wm)(d,{ref:"formRefSignin",id:"profileForm",onSubmit:n.editOrder},{default:(0,f.w5)((({meta:t})=>[(0,f._)("div",ks,[(0,f._)("section",null,[(0,f._)("div",ws,[(0,f.Wm)(i,{name:"廠商",type:"text",rules:n.isCompanyExist,class:"form-control",list:"datalistOptions"},null,8,["rules"]),(0,f._)("datalist",Ds,[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(l.companyList,((t,e)=>((0,f.wg)(),(0,f.iD)("option",{key:e,value:t.companyName},null,8,xs)))),128))]),(0,f._)("label",$s,[(0,f.Uk)("廠商名稱"),(0,f.Wm)(r,{name:"廠商",class:"text-danger ms-3"})])]),(0,f._)("div",Ws,[(0,f.Wm)(i,{name:"施工地址",rules:"required",type:"text",modelValue:l.tempData.address,"onUpdate:modelValue":e[1]||(e[1]=t=>l.tempData.address=t),class:"form-control"},null,8,["modelValue"]),(0,f._)("label",Ms,[(0,f.Uk)("施工地址"),(0,f.Wm)(r,{name:"施工地址",class:"text-danger ms-3"})])]),(0,f._)("div",Vs,[(0,f.Wm)(i,{name:"施工日期",rules:"required",type:"date",modelValue:l.tempData.constructionDate,"onUpdate:modelValue":e[2]||(e[2]=t=>l.tempData.constructionDate=t),class:"form-control"},null,8,["modelValue"]),(0,f._)("label",Cs,[(0,f.Uk)("施工日期"),(0,f.Wm)(r,{name:"施工日期",class:"text-danger ms-3"})])]),(0,f._)("div",Us,[(0,f.Wm)(i,{name:"付款方式",as:"select",rules:"required",class:"form-control",modelValue:l.tempData.paymentMethod,"onUpdate:modelValue":e[3]||(e[3]=t=>l.tempData.paymentMethod=t)},{default:(0,f.w5)((()=>[Os,Ss])),_:1},8,["modelValue"]),(0,f._)("label",Ls,[(0,f.Uk)("付款方式"),(0,f.Wm)(r,{name:"付款方式",class:"text-danger ms-3"})])]),(0,f._)("div",Es,[(0,f.Wm)(i,{name:"總金額",type:"number",rules:"required",modelValue:l.tempData.total,"onUpdate:modelValue":e[4]||(e[4]=t=>l.tempData.total=t),class:"form-control"},null,8,["modelValue"]),(0,f._)("label",Is,[(0,f.Uk)("總金額"),(0,f.Wm)(r,{name:"總金額",class:"text-danger ms-3"})])]),(0,f._)("div",Ps,[(0,f.Wm)(i,{name:"保留款",type:"number",modelValue:l.tempData.retainage,"onUpdate:modelValue":e[5]||(e[5]=t=>l.tempData.retainage=t),class:"form-control"},null,8,["modelValue"]),(0,f._)("label",Zs,[(0,f.Uk)("保留款"),(0,f.Wm)(r,{name:"保留款",class:"text-danger ms-3"})])])]),(0,f._)("section",null,[Ns,(0,f._)("div",As,[(0,f._)("div",js,[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(l.workerList,((t,e)=>((0,f.wg)(),(0,f.iD)("button",{key:e,type:"button",class:(0,_.C_)(["btn",t.status?"btn-primary":"btn-outline-primary"]),onClick:a=>n.toggleCheck(t,e)},(0,_.zw)(t.name),11,zs)))),128))]),((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(l.tempWorkerList,((t,e)=>((0,f.wg)(),(0,f.iD)("div",{key:e,class:"input-group mb-2"},[(0,f.wy)((0,f._)("input",{type:"text",placeholder:"工人姓名",class:"form-control","onUpdate:modelValue":e=>t.name=e,disabled:""},null,8,Ts),[[s.nr,t.name]]),(0,f._)("input",{type:"text",placeholder:"工人電話",class:"form-control",value:t.phone,disabled:""},null,8,Fs),(0,f.wy)((0,f._)("input",{type:"number",placeholder:"工作時數",class:"form-control","onUpdate:modelValue":t=>l.tempWorkerList[e].time=t},null,8,qs),[[s.nr,l.tempWorkerList[e].time]])])))),128))]),Hs,(0,f._)("div",null,[Rs,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(l.tempData.transferWorkers,((t,e)=>((0,f.wg)(),(0,f.iD)("div",{key:e,class:"input-group mb-2"},[(0,f.wy)((0,f._)("input",{type:"text",placeholder:"工人姓名",class:"form-control","onUpdate:modelValue":t=>l.tempData.transferWorkers[e].name=t},null,8,Js),[[s.nr,l.tempData.transferWorkers[e].name]]),(0,f.wy)((0,f._)("input",{type:"text","aria-label":"Last name",placeholder:"工人電話",class:"form-control","onUpdate:modelValue":t=>l.tempData.transferWorkers[e].phone=t},null,8,Ys),[[s.nr,l.tempData.transferWorkers[e].phone]]),(0,f.wy)((0,f._)("input",{type:"number","aria-label":"Last name",placeholder:"工作時數",class:"form-control","onUpdate:modelValue":t=>l.tempData.transferWorkers[e].time=t},null,8,Ks),[[s.nr,l.tempData.transferWorkers[e].time]]),(0,f._)("button",{class:"btn btn-outline-danger",type:"button",id:"button-add",onClick:t=>n.deleteTransArray(e)}," 刪除 ",8,Bs)])))),128)),(0,f._)("div",Gs,[(0,f._)("button",{class:"btn btn-outline-dark",type:"button",onClick:e[6]||(e[6]=(...t)=>n.addTransArray&&n.addTransArray(...t))}," 新增 ")])])])]),(0,f._)("div",Qs,[l.status?(0,f.kq)("",!0):((0,f.wg)(),(0,f.iD)("button",{key:0,type:"button",class:"btn btn-outline-danger",onClick:e[7]||(e[7]=t=>n.deleteOrder(l.tempData._id))}," 刪除該工單 ")),Xs,(0,f._)("button",{type:"submit",class:"btn btn-primary",disabled:!t.valid}," 儲存 ",8,to)])])),_:1},8,["onSubmit"])])])],512)}var ao={data(){return{modal:"",status:!1,tempData:{address:"",company:"",status:0,paymentMethod:"",total:0,retainage:0,constructionDate:"",workers:[],transferWorkers:[]},tempWorker:[],companyList:[],workerList:[],tempWorkerList:[]}},watch:{},methods:{isCompanyExist(t){this.tempData.company="";let e="";return this.companyList.forEach((a=>{a.companyName===t&&(e=a.company,this.tempData.company=a._id)})),""!==e||"查無此廠商"},getCompany(){this.$emitter.emit("loadingStatus",!0),(0,_t.rO)().then((t=>{this.$emitter.emit("loadingStatus",!1),this.companyList=t.data.data})).catch((t=>{this.$emitter.emit("loadingStatus",!1),console.log(t)}))},getWorker(){this.$emitter.emit("loadingStatus",!0),(0,_t.mL)().then((t=>{this.$emitter.emit("loadingStatus",!1),this.workerList=t.data.data})).catch((t=>{this.$emitter.emit("loadingStatus",!1),console.log(t)}))},toggleCheck(t,e){if(this.workerList[e].status=!t.status,t.status)this.tempWorkerList.push(t);else{const e=e=>e._id===t._id,a=this.tempWorkerList.findIndex(e);this.tempWorkerList.splice(a,1)}},deleteOrder(t){this.$emitter.emit("loadingStatus",!0),(0,_t.LW)(t).then((()=>{this.$emitter.emit("loadingStatus",!1),this.$emitter.emit("messageModal",{status:!0,message:"刪除成功"}),this.$emitter.emit("getOrder"),this.hideModal()})).catch((t=>{console.log(t)}))},editOrder(){this.tempData.workers=this.tempWorkerList,(0,_t.WA)(this.tempData).then((()=>{this.$emitter.emit("loadingStatus",!1),this.$emitter.emit("messageModal",{status:!0,message:"修改成功"}),this.$emitter.emit("getOrder"),this.hideModal()})).catch((t=>{console.log(t),this.$emitter.emit("loadingStatus",!1)}))},addTransArray(){this.tempData.transferWorkers.push({})},deleteTransArray(t){this.tempData.transferWorkers.splice(t,1)},showModal(){this.modal.show()},hideModal(){this.tempData={address:"",company:"",status:0,paymentMethod:"",total:0,retainage:0,constructionDate:"",workers:[],transferWorkers:[]},this.modal.hide()}},mounted(){this.getCompany(),this.getWorker(),this.modal=new u.u_(this.$refs.edit),this.$emitter.on("editOrder",(t=>{this.status=t.status,t.status||(this.tempData=JSON.parse(JSON.stringify(t.data)),this.tempData.workers.forEach((t=>{this.workerList.forEach((e=>{t._id._id===e._id&&(e.status=!0)}))})),this.tempWorkerList=[],this.workerList.forEach((t=>{t.status&&this.tempWorkerList.push(t)})),this.tempWorkerList.forEach((t=>{this.tempData.workers.forEach((e=>{t._id===e._id._id&&(t.time=e.time)}))}))),this.showModal()}))}};const so=(0,S.Z)(ao,[["render",eo]]);var oo=so;const lo={class:"modal fade",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"cooperate"},no={class:"modal-dialog modal-lg"},io={class:"modal-content"},ro=(0,f._)("div",{class:"modal-header"},[(0,f._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),mo={class:"modal-body"},uo={class:"table table-striped"},co=(0,f._)("thead",null,[(0,f._)("tr",null,[(0,f._)("th",{scope:"col"},"#"),(0,f._)("th",{scope:"col"},"工程名稱"),(0,f._)("th",{scope:"col"},"金額"),(0,f._)("th",{scope:"col"},"日期"),(0,f._)("th",{scope:"col"},"是否完成")])],-1),po={scope:"row"},ho={key:0},fo={key:1};function bo(t,e,a,s,o,l){return(0,f.wg)(),(0,f.iD)("div",lo,[(0,f._)("div",no,[(0,f._)("div",io,[ro,(0,f._)("div",mo,[(0,f._)("table",uo,[co,(0,f._)("tbody",null,[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(o.tempData,((t,e)=>((0,f.wg)(),(0,f.iD)("tr",{key:e},[(0,f._)("th",po,(0,_.zw)(e+1),1),(0,f._)("td",null,(0,_.zw)(t._id),1),(0,f._)("td",null,(0,_.zw)(t.total),1),(0,f._)("td",null,(0,_.zw)(t.constructionDate),1),(0,f._)("td",null,[(0,f._)("button",{class:(0,_.C_)(["btn",[t.status?"btn-outline-success":"btn-outline-danger"]]),disabled:""},[t.status?((0,f.wg)(),(0,f.iD)("span",ho,"完工")):((0,f.wg)(),(0,f.iD)("span",fo,"未完工"))],2)])])))),128))])])])])])],512)}var go={data(){return{modal:"",tempData:"",tempOrder:""}},methods:{getOrder(t){this.$emitter.emit("loadingStatus",!0),(0,_t.IP)(t).then((t=>{this.$emitter.emit("loadingStatus",!1),this.tempOrder=t.data.data})).catch((t=>{this.$emitter.emit("loadingStatus",!1),console.log(t)}))},getCooperList(t){this.$emitter.emit("loadingStatus",!0),(0,_t.fy)(t).then((t=>{this.$emitter.emit("loadingStatus",!1),this.tempData=t.data.data})).catch((t=>{this.$emitter.emit("loadingStatus",!1),console.log(t.response.data.message)}))},showModal(){this.modal.show()}},mounted(){this.modal=new u.u_(this.$refs.cooperate),this.$emitter.on("cooperList",(t=>{this.getCooperList(t),this.showModal()}))}};const _o=(0,S.Z)(go,[["render",bo]]);var yo=_o,vo={components:{Loading:z,Message:J,Navbar:E,WorkRecordModal:kt,AddEditCompany:Ie,AddEditOrder:Sa,AddEditWorker:ps,PDF:me,EditOrder:oo,CooperateModal:yo},methods:{checkSignIn(){const t=(0,U.LP)();t?this.$http.defaults.headers.common.Authorization=`Bearer ${t}`:this.$router.push("/login")},signOut(){(0,U.qz)(),this.$router.push("/signin")}},created(){this.checkSignIn()}};const ko=(0,S.Z)(vo,[["render",g]]);var wo=ko,Do=a(2201);const xo=[{path:"/",name:"index",component:()=>a.e(796).then(a.bind(a,2796))},{path:"/login",name:"login",component:()=>a.e(854).then(a.bind(a,8854))},{path:"/personnel",name:"personnel",component:()=>a.e(898).then(a.bind(a,8898))},{path:"/company",name:"company",component:()=>a.e(457).then(a.bind(a,6457))},{path:"/order",name:"order",component:()=>a.e(860).then(a.bind(a,3860))}],$o=(0,Do.p7)({history:(0,Do.r5)(),routes:xo});var Wo=$o;Object.keys(l).forEach((t=>{(0,o.aH)(t,l[t])})),(0,o.jQ)({generateMessage:(0,n.NC)({zh_TW:i}),validateOnInput:!0}),(0,n.i_)("zh_TW");const Mo=(0,m.Z)(),Vo=(0,s.ri)(wo);Vo.config.globalProperties.$emitter=Mo,Vo.config.globalProperties.$toCurrency=h,Vo.component("VField",o.gN),Vo.component("VForm",o.l0),Vo.component("ErrorMessage",o.Bc),Vo.use(r.LoadingPlugin),Vo.use(p.Z,c.Z),Vo.use(Wo),Wo.afterEach((()=>{window.scrollTo(0,0)})),Vo.mount("#app")}},e={};function a(s){var o=e[s];if(void 0!==o)return o.exports;var l=e[s]={id:s,loaded:!1,exports:{}};return t[s].call(l.exports,l,l.exports,a),l.loaded=!0,l.exports}a.m=t,function(){a.amdO={}}(),function(){var t=[];a.O=function(e,s,o,l){if(!s){var n=1/0;for(m=0;m<t.length;m++){s=t[m][0],o=t[m][1],l=t[m][2];for(var i=!0,r=0;r<s.length;r++)(!1&l||n>=l)&&Object.keys(a.O).every((function(t){return a.O[t](s[r])}))?s.splice(r--,1):(i=!1,l<n&&(n=l));if(i){t.splice(m--,1);var d=o();void 0!==d&&(e=d)}}return e}l=l||0;for(var m=t.length;m>0&&t[m-1][2]>l;m--)t[m]=t[m-1];t[m]=[s,o,l]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){var t,e=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__};a.t=function(s,o){if(1&o&&(s=this(s)),8&o)return s;if("object"===typeof s&&s){if(4&o&&s.__esModule)return s;if(16&o&&"function"===typeof s.then)return s}var l=Object.create(null);a.r(l);var n={};t=t||[null,e({}),e([]),e(e)];for(var i=2&o&&s;"object"==typeof i&&!~t.indexOf(i);i=e(i))Object.getOwnPropertyNames(i).forEach((function(t){n[t]=function(){return s[t]}}));return n["default"]=function(){return s},a.d(l,n),l}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.f={},a.e=function(t){return Promise.all(Object.keys(a.f).reduce((function(e,s){return a.f[s](t,e),e}),[]))}}(),function(){a.u=function(t){return"js/"+t+"."+{43:"2b619f09",457:"b21a58f7",796:"cb22b224",854:"5c2acb94",856:"565a2406",860:"630fa03c",898:"b3140826"}[t]+".js"}}(),function(){a.miniCssF=function(t){}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.hmd=function(t){return t=Object.create(t),t.children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t}}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="web:";a.l=function(s,o,l,n){if(t[s])t[s].push(o);else{var i,r;if(void 0!==l)for(var d=document.getElementsByTagName("script"),m=0;m<d.length;m++){var u=d[m];if(u.getAttribute("src")==s||u.getAttribute("data-webpack")==e+l){i=u;break}}i||(r=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.setAttribute("data-webpack",e+l),i.src=s),t[s]=[o];var c=function(e,a){i.onerror=i.onload=null,clearTimeout(p);var o=t[s];if(delete t[s],i.parentNode&&i.parentNode.removeChild(i),o&&o.forEach((function(t){return t(a)})),e)return e(a)},p=setTimeout(c.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=c.bind(null,i.onerror),i.onload=c.bind(null,i.onload),r&&document.head.appendChild(i)}}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.p=""}(),function(){var t={143:0};a.f.j=function(e,s){var o=a.o(t,e)?t[e]:void 0;if(0!==o)if(o)s.push(o[2]);else{var l=new Promise((function(a,s){o=t[e]=[a,s]}));s.push(o[2]=l);var n=a.p+a.u(e),i=new Error,r=function(s){if(a.o(t,e)&&(o=t[e],0!==o&&(t[e]=void 0),o)){var l=s&&("load"===s.type?"missing":s.type),n=s&&s.target&&s.target.src;i.message="Loading chunk "+e+" failed.\n("+l+": "+n+")",i.name="ChunkLoadError",i.type=l,i.request=n,o[1](i)}};a.l(n,r,"chunk-"+e,e)}},a.O.j=function(e){return 0===t[e]};var e=function(e,s){var o,l,n=s[0],i=s[1],r=s[2],d=0;if(n.some((function(e){return 0!==t[e]}))){for(o in i)a.o(i,o)&&(a.m[o]=i[o]);if(r)var m=r(a)}for(e&&e(s);d<n.length;d++)l=n[d],a.o(t,l)&&t[l]&&t[l][0](),t[l]=0;return a.O(m)},s=self["webpackChunkweb"]=self["webpackChunkweb"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(2159)}));s=a.O(s)})();
//# sourceMappingURL=app.1d5dd56e.js.map